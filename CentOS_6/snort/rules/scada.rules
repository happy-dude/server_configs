# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#-------------
# SCADA RULES
#-------------

# alert tcp $EXTERNAL_NET ANY -> $HOME_NET 20222 (msg:"SCADA CitectSCADA ODBC buffer overflow attempt"; flow:to_server,established; content:"|02 00 00 00 00|"; depth:9; byte_test:4,>=,225,0,relative; metadata:policy security-ips drop; reference:bugtraq,29634; reference:cve,2008-2639; reference:url,www.citect.com/index.php?option=com_content&task=view&id=1374&Itemid=223; classtype:attempted-admin; sid:14265; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write multiple coils - too many outputs"; flow:to_server,established; modbus_func:write_multiple_coils; byte_test:2,>,1968,10; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15076; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus user-defined function code - 65 to 72"; flow:to_server,established; byte_test:1,>,64,7; byte_test:1,<,73,7; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15074; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read multiple coils - too many inputs"; flow:to_server,established; modbus_func:read_coils; byte_test:2,>,2000,10; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15077; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus user-defined function code - 100 to 110"; flow:to_server,established; byte_test:1,>,99,7; byte_test:1,<,111,7; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15075; rev:4;)
# alert tcp $EXTERNAL_NET 502 -> $HOME_NET any (msg:"SCADA Modbus exception returned"; flow:established,to_client; byte_test:1,&,128,7; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15071; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory card format attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|22 04|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15411; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS file memory write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|22 11|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15407; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory area fill attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|01 03|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15390; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory area write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|01 02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15389; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS RESET attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|04 03|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15409; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS program area clear attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|03 08|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15397; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory area fill overflow attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|01 03|"; depth:2; offset:10; isdataat:8,relative; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15413; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS access right forced acquire attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|0C 02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15402; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS program area protect clear attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|03 05|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15395; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS STOP attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|04 02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15399; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS file delete attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|22 05|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15404; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS parameter area clear attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|02 03|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15393; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS access right acquire attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|0C 01|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15401; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS forced set/reset cancel attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|23 01|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15406; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS RUN attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|04 01|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15398; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory area write overflow attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|01 02|"; depth:2; offset:10; isdataat:10,relative; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15412; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS memory area transfer attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|01 05|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15391; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS data link table write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|02|!"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15408; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS name delete attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"&|02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15410; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS program area write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|03 07|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15396; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS program area protect clear brute force attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|03 05 00 00 00 00 00 00 00 FF FF FF FF|"; depth:13; offset:10; detection_filter:track by_src, count 10, seconds 60; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15414; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS single file write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|22 03|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15403; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS clock write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|07 02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15400; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS parameter area write attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|02 02|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15392; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS forced set/reset attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|23 01|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15405; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 9600 (msg:"SCADA OMRON-FINS program area protect attempt"; flow:to_server; byte_test:1,!&,64,0; content:"|00 02|"; depth:2; offset:1; content:"|03 04|"; depth:2; offset:10; reference:url,forums.mrplc.com/index.php?download=467; classtype:protocol-command-decode; sid:15394; rev:3;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 parameter error"; flow:established,to_client; dnp3_ind:parameter_error; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15716; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 unsupported function code error"; flow:established,to_client; dnp3_ind:no_func_code_support; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15718; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 corrupt configuration"; flow:established,to_client; dnp3_ind:config_corrupt; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15714; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 link service not supported"; flow:established,to_client; content:"|05|d"; depth:2; byte_test:1,!&,64,1,relative; byte_test:1,&,1,3; byte_test:1,&,2,3; byte_test:1,&,4,3; byte_test:1,&,8,3; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15719; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 unknown object error"; flow:established,to_client; dnp3_ind:object_unknown; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15717; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 event buffer overflow error"; flow:established,to_client; dnp3_ind:event_buffer_overflow; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15715; rev:4;)
# alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any (msg:"SCADA DNP3 device trouble"; flow:established,to_client; dnp3_ind:device_trouble; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15713; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read fifo queue from external source"; flow:to_server,established; modbus_func:read_fifo_queue; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17792; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read coils from external source"; flow:to_server,established; modbus_func:read_coils; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17788; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus initiate diagnostic from external source"; flow:to_server,established; modbus_func:diagnostics; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17795; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus mask write register from external source"; flow:to_server,established; modbus_func:mask_write_register; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17800; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write file record from external source"; flow:to_server,established; modbus_func:write_file_record; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17786; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus report slave id from external source"; flow:to_server,established; modbus_func:report_slave_id; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17798; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read exception status from external source"; flow:to_server,established; modbus_func:read_exception_status; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17794; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write single coil from external source"; flow:to_server,established; modbus_func:write_single_coil; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17784; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus get com event counter from external source"; flow:to_server,established; modbus_func:get_comm_event_counter; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17796; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write multiple registers from external source"; flow:to_server,established; modbus_func:write_multiple_registers; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17782; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write multiple coils from external source"; flow:to_server,established; modbus_func:write_multiple_coils; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17785; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus get com event log from external source"; flow:to_server,established; modbus_func:get_comm_event_log; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17797; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read input register from external source"; flow:to_server,established; modbus_func:read_input_registers; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17789; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read/write multiple registers from external source"; flow:to_server,established; modbus_func:read_write_multiple_registers; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17791; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus write single register from external source"; flow:to_server,established; modbus_func:write_single_register; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17783; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read device identification from external source"; flow:to_server,established; modbus_func:report_slave_id; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17799; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read holding registers from external source"; flow:to_server,established; modbus_func:read_holding_registers; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17790; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read file record from external source"; flow:to_server,established; modbus_func:read_file_record; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17793; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 502 (msg:"SCADA Modbus read discrete inputs from external source"; flow:to_server,established; modbus_func:read_discrete_inputs; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17787; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 777 (msg:"SCADA Kingview HMI heap overflow attempt"; flow:to_server,established; stream_size:client,>,2000; content:"|90 90 90 90 90 90 90 90|"; fast_pattern:only; reference:bugtraq,45727; reference:cve,2011-0406; classtype:attempted-admin; sid:18327; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe strep overflow attempt"; flow:to_server,established; content:"|04 00 00 00|"; fast_pattern:only; content:"|08|"; depth:1; offset:6; content:"|01 00 00 00|"; within:4; distance:7; isdataat:260,relative; pcre:"/^\x04\x00\x00\x00[^\x00]{256,}/R"; classtype:attempted-admin; sid:18656; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe file upload/download attempt"; flow:to_server,established; content:"|2E 2E|"; fast_pattern:only; content:"|0D|"; depth:1; offset:6; content:"|01 00 00 00|"; within:4; distance:7; pcre:"/^[\x02\x03]\x00\x00\x00[^\x00]*(\x2E{2}[\x5C\x2F]){2}/R"; reference:cve,2011-1567; classtype:attempted-user; sid:18648; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12397 (msg:"SCADA IGSS dc.exe file execution directory traversal attempt"; flow:to_server,established; content:"|2E 2E|"; fast_pattern:only; pcre:"/^.{12}[\x17\x0A]\x00\x00\x00.{28}[^\x00]*(\x2E{2}[\x5C\x2F]){2}/"; reference:cve,2011-1567; classtype:attempted-admin; sid:18657; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"SCADA Tecnomatix FactoryLink vrn.exe file access attempt"; flow:to_server,established; content:"|FF 55 08 00|"; depth:4; offset:4; pcre:"/^.{32}[^\x00\x5C]*\x5C/sR"; reference:bugtraq,46934; classtype:attempted-user; sid:18614; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7580 (msg:"SCADA Tecnomatix FactoryLink CSService path overflow attempt"; flow:to_server,established; content:"LEN|00|"; depth:4; fast_pattern; nocase; content:"|00 00 00 06|"; distance:0; content:"|06|"; within:1; distance:4; byte_test:4,>,1024,0,relative,big; reference:bugtraq,46934; classtype:attempted-admin; sid:18605; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe report template overflow attempt"; flow:to_server,established; content:"|07|"; depth:1; offset:6; content:"|01 00 00 00|"; within:4; distance:7; isdataat:260,relative; pcre:"/^[\x04\x05\x06]\x00\x00\x00[^\x00]{256,}/R"; classtype:attempted-admin; sid:18651; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_CONNECT_FCS_LOGIN overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; content:"|01 00 01 00|"; within:4; distance:6; byte_test:4,>,1024,-10,little,relative; isdataat:1024,relative; content:!"|00|"; within:1024; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18658; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe file operation overflow attempt"; flow:to_server,established; content:"|01 00 34 12|"; depth:4; offset:2; isdataat:466,relative; pcre:"/^.{2}\x01\x00\x34\x12.{12}[\x01\x02\x03\x04\x05\x06\x07]\x00\x00\x00[^\x00]{444,}/"; reference:cve,2011-1567; reference:cve,2011-4050; classtype:attempted-admin; sid:18649; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe format string attempt"; flow:to_server,established; content:"|25 6E|"; fast_pattern:only; content:"|07|"; depth:1; offset:6; content:"|01 00 00 00|"; within:4; distance:7; pcre:"/^\x03\x00\x00\x00[^\x00]*\x25\x6e/R"; classtype:attempted-admin; sid:18654; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe report template operation overflow attempt"; flow:to_server,established; content:"|34 12 07 00|"; depth:4; offset:4; content:"|01 00 00 00|"; within:4; distance:6; isdataat:512,relative; pcre:"/^[\x02\x03\x04]\x00\x00\x00.*?\x00[^\x00]{512,}/R"; classtype:attempted-admin; sid:18652; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7580 (msg:"SCADA Tecnomatix FactoryLink CSService file information access attempt"; flow:to_server,established; content:"LEN|00|"; depth:4; fast_pattern; nocase; content:"|00 00 00 10|"; distance:0; content:"|06|"; within:1; distance:4; byte_extract:4,0,str_size,relative,big; content:"|5C|"; within:str_size; distance:8; reference:bugtraq,46934; classtype:attempted-user; sid:18607; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"SCADA Tecnomatix FactoryLink vrn.exe opcode 9 or 10 string parsing overflow attempt"; flow:to_server,established; content:"|FF 55|"; depth:2; offset:4; isdataat:933,relative; pcre:"/^[\x0A\x09]\x00.{32}[^\x3B]{900}/sR"; reference:bugtraq,46934; classtype:attempted-user; sid:18610; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"SCADA RealWin 2.1 SCPC_INITIALIZE overflow attempt"; flow:to_server,established; content:"|64 12 54 6A|"; depth:4; byte_test:4,>,200,8,little; pcre:"/^\x64\x12\x54\x6A[\x02\x20\x10]\x00\x00\x00/"; metadata:policy security-ips drop; reference:bugtraq,44150; reference:cve,2010-4142; classtype:attempted-admin; sid:18659; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 7580 (msg:"SCADA Tecnomatix FactoryLink CSService file access attempt"; flow:to_server,established; content:"LEN|00|"; depth:4; fast_pattern; nocase; content:"|00 00 00 08|"; distance:0; content:"|06|"; within:1; distance:4; byte_extract:4,0,str_size,relative,big; content:"|5C|"; within:str_size; distance:8; reference:bugtraq,46934; classtype:attempted-user; sid:18606; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B2 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B2 04 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18738; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x40000000,32,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18733; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x1BBC heap overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|BC 1B 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; distance:4; byte_jump:1,4,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x0040,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18729; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,28,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18734; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x1C84 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|84 1C 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x10000000,4,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18722; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x089A integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|9A 08 00 00|"; depth:4; offset:20; fast_pattern; content:"|00 20|"; within:2; distance:4; byte_test:4,>,0x20000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18730; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0DAE heap overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|AE 0D 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x0040,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18728; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x40000000,28,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18735; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B5 heap overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B5 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x0040,8,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18727; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x1C84 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|84 1C 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x10000000,4,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18721; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0453 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|53 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,22,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18731; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,24,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18736; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B2 heap overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B2 04 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x0040,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18726; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,32,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18732; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00|"; depth:3; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x40000000,24,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18737; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B0 heap overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B0 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x0040,28,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18725; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x1BBC integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|BC 1B 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; distance:4; byte_jump:1,4,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18787; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_CTAGLIST_FCS_XTAG overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; byte_test:4,>,1024,0,little,relative; isdataat:1024,relative; pcre:"/^.{6}\x05\x00[\x01\x02\x05]\x00.*?\x00[^\x00]{1024}/msR"; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18746; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0DB0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B0 0D 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18784; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B5 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B5 04 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x40000000,8,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18779; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_INFOTAG_SET_CONTROL overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; content:"|11 00 01 00|"; within:4; distance:6; byte_test:4,>,400,-10,little,relative; isdataat:400,relative; content:!"|00|"; within:400; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18752; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x1BBD integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|BD 1B 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; distance:4; byte_jump:1,4,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18788; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_CTAGLIST_FCS_XTAG overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; byte_test:4,>,200,0,little,relative; isdataat:200,relative; pcre:"/^.{6}[\x02\x04]\x00[\x0f\x10\x12\x13]\x00[^\x00]{200}/msR"; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18749; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0DAE integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|AE 0D 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18783; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0FA4 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|A4 0F 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x20000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18785; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x04B5 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|B5 04 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,8,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18778; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x26AC integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|AC 26 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18789; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x07D0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|D0 07 00 00|"; depth:4; offset:20; fast_pattern; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; content:!"|FF|"; within:1; byte_jump:1,0,relative; byte_test:4,>,0x40000000,4,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18780; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_MISC_FCS_MSGx overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; pcre:"/^.{6}\x0f\x00[\x01\x03]\x00/msR"; byte_test:4,>,0xffffffe9,0,relative,little; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18748; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_BINFILE_FCS_xFILE overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; byte_test:4,>,256,0,little,relative; isdataat:256,relative; pcre:"/^.{6}\x10\x00[\x01\x03\x08\x0A\x0B\x0D]\x00.{12}[^\x00]{256}/msR"; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18747; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x0FA7 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|A7 0F 00 00|"; depth:4; offset:20; fast_pattern; byte_test:4,>,0x40000000,0,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18786; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 38080 (msg:"SCADA Iconics Genesis 32/64 GenBroker opcode 0x07D0 integer overflow attempt"; flow:to_server,established; content:"|01 00 00 01|"; depth:4; content:"|D0 07 00 00|"; depth:4; offset:20; fast_pattern; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; content:"|FF|"; within:1; byte_jump:2,0,relative,little; byte_test:4,>,0x40000000,4,relative,little; reference:url,www.vupen.com/english/advisories/2011/0740; classtype:attempted-admin; sid:18781; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA RealWin 2.1 FC_SCRIPT_FCS_STARTPROG overflow attempt"; flow:to_server,established; content:"|10 23 54 67|"; depth:4; content:"|09 00 12 00|"; within:4; distance:6; byte_test:4,>,4096,-10,little,relative; stream_size:client,>,4096; reference:url,secunia.com/advisories/43848; classtype:attempted-admin; sid:18750; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"SCADA IGSS IGSSDataServer.exe file operation directory traversal attempt"; flow:to_server,established; content:"|01 00 34 12|"; depth:4; offset:2; content:"|0D|"; within:1; content:"|2E 2E|"; fast_pattern:only; pcre:"/.{18}[\x01\x02\x03\x04\x05\x06]\x00\x00\x00.+?(\x2E{2}[\x5C\x2F]){2}/"; reference:cve,2011-1567; classtype:attempted-admin; sid:20030; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 3250 (msg:"SCADA IntelliCom NetBiter config utility hostname overflow attempt"; flow:stateless; content:"hn"; nocase; isdataat:31,relative; pcre:"/^\s?=\s?[^\x3B]{31}/R"; reference:bugtraq,37325; reference:url,support.intellicom.se/showfile.cfm?FID=45; classtype:attempted-admin; sid:20052; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Cogent DataHub server-side information disclosure"; flow:to_server,established; content:".asp "; nocase; http_uri; pcre:"/\x2easp ($|\?)/iU"; metadata:service http; reference:cve,2011-3502; classtype:web-application-attack; sid:20173; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4446 (msg:"SCADA RSLogix rna protocol denial of service attempt"; flow:to_server,established; content:"rna|F2 FF FF FF|"; depth:7; content:"aaaaaaaaaa"; within:10; distance:1; pcre:"/^rna\xf2\xff\xff\xff[\x7f\xff]/"; reference:cve,2011-3489; reference:url,aluigi.altervista.org/adv/rslogix_1-adv.txt; classtype:attempted-dos; sid:20178; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Cogent DataHub server-side information disclosure"; flow:to_server,established; content:".asp."; nocase; http_uri; pcre:"/\x2easp\x2e($|\?)/iU"; metadata:service http; reference:cve,2011-3502; classtype:web-application-attack; sid:20174; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 20034 (msg:"SCADA DAQFactory NETB protcol stack overflow attempt"; flow:to_server; dsize:>370; content:"NETB"; depth:4; content:"|00|"; within:6; distance:230; reference:cve,2011-3492; reference:url,aluigi.altervista.org/adv/daqfactory_1-adv.txt; classtype:attempted-admin; sid:20176; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4502 (msg:"SCADA Cogent unicode buffer overflow attempt"; flow:to_server,established; content:"(slave "; nocase; content:"|22|"; within:3; isdataat:100,relative; content:!"|22|"; within:100; metadata:policy security-ips drop, service http; reference:cve,2011-3493; classtype:attempted-admin; sid:20210; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4502 (msg:"SCADA Cogent unicode buffer overflow attempt"; flow:to_server,established; content:"(register_datahub "; nocase; content:"|22|"; within:3; isdataat:100,relative; content:!"|22|"; within:100; metadata:policy security-ips drop, service http; reference:cve,2011-3493; classtype:attempted-admin; sid:20209; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4502 (msg:"SCADA Cogent unicode buffer overflow attempt"; flow:to_server,established; content:"(domain "; nocase; content:"|22|"; within:3; isdataat:100,relative; content:!"|22|"; within:10100; metadata:policy security-ips drop, service http; reference:cve,2011-3493; classtype:attempted-admin; sid:20207; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4502 (msg:"SCADA Cogent unicode buffer overflow attempt"; flow:to_server,established; content:"(report_domain "; nocase; content:"|22|"; within:3; isdataat:100,relative; content:!"|22|"; within:100; metadata:policy security-ips drop, service http; reference:cve,2011-3493; classtype:attempted-admin; sid:20208; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 48899 (msg:"SCADA Beckhoff TwinCAT DoS"; content:"|03 66 14 71|"; isdataat:23; metadata:policy security-ips drop; reference:cve,2011-3486; classtype:attempted-dos; sid:20216; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 11234 (msg:"SCADA Measuresoft ScadaPro msvcrt.dll local command execution attempt"; flow:to_server,established; content:"xf%"; depth:3; content:"msvcrt.dll"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-3490; reference:cve,2011-3495; reference:cve,2011-3496; reference:cve,2011-3497; classtype:attempted-admin; sid:20214; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 11234 (msg:"SCADA Measuresoft ScadaPro directory traversal file operation attempt"; flow:to_server,established; content:"..|5C|..|5C|"; fast_pattern:only; pcre:"/^[xounwR]f\x25[^\n]*(\.\.\x5C){2}/i"; metadata:policy security-ips drop; reference:cve,2011-3490; reference:cve,2011-3495; reference:cve,2011-3496; reference:cve,2011-3497; classtype:attempted-admin; sid:20215; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SCADA Broadwin WebAccess ActiveX clsid access"; flow:established,to_client; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)/siO"; metadata:service http, service imap, service pop3; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:20582; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SCADA Broadwin WebAccess ActiveX clsid access"; flow:established,to_client; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)/siO"; metadata:service http, service imap, service pop3; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:20581; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Progea Movicon/PowerHMI EIDP over HTTP memory corruption attempt"; flow:to_server,established; content:"EIDP"; depth:4; http_client_body; byte_test:4,>,0x7FFFFFFF,16,little,relative; metadata:policy security-ips drop, service http; reference:bugtraq,49605; reference:cve,2011-3491; reference:cve,2011-3498; reference:cve,2011-3499; classtype:attempted-admin; sid:20638; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SCADA Microsys PROMOTIC ActiveX function call access"; flow:established,to_client; file_data; content:"PmTrdvw.TrendsViewCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22PmTrdvw\.TrendsViewCtl(\.\d)?\x22|\x27PmTrdvw\.TrendsViewCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(SaveCfg|AddTrend)\s*|.*(?P=v)\s*\.\s*(SaveCfg|AddTrend)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22PmTrdvw\.TrendsViewCtl(\.\d)?\x22|\x27PmTrdvw\.TrendsViewCtl(\.\d)?\x27)\s*\)(\s*\.\s*(SaveCfg|AddTrend)\s*|.*(?P=n)\s*\.\s*(SaveCfg|AddTrend)\s*)/smiO"; metadata:service http; reference:url,aluigi.altervista.org/adv/promotic_1-adv.txt; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-11-286-01.pdf; classtype:attempted-user; sid:21001; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SCADA Microsys PROMOTIC ActiveX clsid access"; flow:established,to_client; file_data; content:"02000002-9DFA-4B37-ABE9-1929F4BCDEA2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*(SaveCfg|AddTrend)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.(SaveCfg|AddTrend))/siO"; metadata:service http; reference:url,aluigi.altervista.org/adv/promotic_1-adv.txt; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-11-286-01.pdf; classtype:attempted-user; sid:21000; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Siemens SIMATIC HMI Administrator cookie detected"; flow:to_server,established; content:"EAAAAPiZE5314QWTlkMUFedwxt0qYWRtaW5pc3RyYXRvcio"; content:"EAAAAPiZE5314QWTlkMUFedwxt0qYWRtaW5pc3RyYXRvcio"; http_cookie; metadata:service http; reference:cve,2011-4508; reference:url,www.us-cert.gov/control_systems/pdf/ICSA-11-356-01.pdf; classtype:policy-violation; sid:21079; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"SCADA Sunway ForceControl SNMP NetDBServer integer signedness buffer overflow attempt"; flow:to_server,established; content:"|EB 50 EB 50|"; depth:4; byte_test:2,=,87,4,little; content:"|0D 0A|"; byte_test:1,>,32,1,relative; reference:url,aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:21148; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"SCADA Sunway ForceControl SNMP NetDBServer integer signedness buffer overflow attempt"; flow:to_server,established; content:"|EB 50 EB 50|"; depth:4; byte_test:2,=,87,4,little; content:"|0D 0A|"; byte_test:1,<,0,1,relative; reference:url,aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:21149; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"SCADA Sunway ForceControl SNMP NetDBServer integer signedness buffer overflow attempt"; flow:to_server,established; content:"|EB 50 EB 50|"; depth:4; byte_test:2,=,87,4,little; content:"|00 00 01 00|"; within:4; distance:4; byte_test:1,>,32,1,relative; reference:url,aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:21146; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"SCADA Sunway ForceControl SNMP NetDBServer integer signedness buffer overflow attempt"; flow:to_server,established; content:"|EB 50 EB 50|"; depth:4; byte_test:2,=,87,4,little; content:"|00 00 01 00|"; within:4; distance:4; byte_test:1,<,0,1,relative; reference:url,aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:21147; rev:1;)
# alert tcp $EXTERNAL_NET 54321 -> $HOME_NET any (msg:"SCADA Moxa Device Manager buffer overflow attempt"; flow:to_client,established; dsize:>1080; content:"|28 10 00 29|"; depth:4; content:"|E8 D5 FD FF FF|"; within:5; distance:1076; metadata:policy security-ips drop; reference:cve,2010-4741; reference:url,reversemode.com/index.php?option=com_content&task=view&id=70&Itemid=1; classtype:attempted-user; sid:21483; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 69 (msg:"SCADA General Electric d20me configuration retrieval attempt"; flow:to_server; content:"|00 01|"; depth:2; content:"D20.zl"; distance:0; nocase; reference:url,www.metasploit.com/modules/auxiliary/gather/d20pass; classtype:attempted-recon; sid:21490; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 46823 (msg:"SCADA Sielco Sistemi Winlog Pro stack buffer overflow attempt"; flow:to_server,established; content:"|02 01 01|"; depth:3; isdataat:70,relative; reference:bugtraq,45813; reference:cve,2011-0517; reference:url,osvdb.org/70418; classtype:attempted-admin; sid:21491; rev:1;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 69 (msg:"SCADA General Electric D20ME backdoor attempt"; flow:to_server; content:"|00 02|"; depth:2; content:"MONITOR:command.log"; distance:0; nocase; reference:url,dev.metasploit.com/redmine/projects/framework/repository/revisions/b73f28f29511d154aed9e94dd262195db60c7e3b/entry/unstable-modules/auxiliary/d20tftpbd.rb; classtype:attempted-admin; sid:21494; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2308,50523] (msg:"SCADA Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt"; flow:to_server,established; isdataat:1024; content:"|00 01 03|"; depth:3; byte_test:4,>,0x410,23,little,relative; reference:cve,2011-4875; reference:url,www.exploit-db.com/exploits/18166/; classtype:attempted-admin; sid:23006; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2308,50523] (msg:"SCADA Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt"; flow:to_server,established; isdataat:1024; content:"|08 00 02|"; depth:3; byte_test:4,>,0x410,23,little,relative; reference:cve,2011-4875; reference:url,www.exploit-db.com/exploits/18166/; classtype:attempted-admin; sid:23007; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2308,50523] (msg:"SCADA Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt"; flow:to_server,established; isdataat:1024; content:"|00 04 02|"; depth:3; byte_test:4,>,0x410,3,little,relative; reference:cve,2011-4875; reference:url,www.exploit-db.com/exploits/18166/; classtype:attempted-admin; sid:23004; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2308,50523] (msg:"SCADA Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt"; flow:to_server,established; isdataat:1024; content:"|00 04 03|"; depth:3; byte_test:4,>,0x410,23,little,relative; reference:cve,2011-4875; reference:url,www.exploit-db.com/exploits/18166/; classtype:attempted-admin; sid:23005; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"SCADA ScadaTec Procyon Core server password overflow attempt"; flow:to_server,established; content:"|66 81 CA FF 0F 42 52 6A 02 58 CD 2E 3C 05 5A 74 EF B8 63 30 30 6C 8B FA AF 75 EA AF 75 E7 FF E7|"; fast_pattern:only; metadata:service telnet; reference:bugtraq,49480; reference:cve,2011-3322; classtype:attempted-user; sid:23330; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA BroadWin WebAccess Client format string exploit attempt"; flow:to_server,established; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/<\s*script\s*\S*\s*>.*?[a-z0-9_-]+\.OcxSpool\s*\x28\s*([\x22\x27])[^\1]*(\x25[dlnpsx])[^\1]*\1/smi"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:23964; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA BroadWin WebAccess Client arbitrary memory corruption attempt"; flow:to_server,established; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/<\s*script\s*>.*?[a-z0-9_-]+\.(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29\s*\x3b/smi"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:23965; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Sinapsi command injection attempt"; flow:to_server,established; content:"/ping.php"; fast_pattern:only; http_uri; content:"ip_dominio"; http_uri; pcre:"/ip_dominio\s+[\x26\x3b\x7c\x3e\x3c]/Ui"; metadata:service http; reference:url,www.exploit-db.com/exploits/21273/; classtype:web-application-attack; sid:24425; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA DATAC RealWin System buffer overflow attempt"; flow:to_server,established; content:"|10 23|Tg"; depth:4; byte_test:4,>,700,0,relative,little; content:"|0A 00 05 00|"; within:4; distance:6; metadata:policy security-ips drop; reference:cve,2011-1563; classtype:attempted-user; sid:24481; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Sinapsi SQL injection attempt"; flow:to_server,established; content:"/changelanguagesession.php"; fast_pattern:only; http_uri; pcre:"/[?&]lingua=[^&]+?([\x22\x27]|SELECT|UPDATE|INSERT)/Ui"; metadata:service http; reference:url,www.exploit-db.com/exploits/21273/; classtype:web-application-attack; sid:24422; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA DATAC RealWin System buffer overflow attempt"; flow:to_server,established; content:"|10 23|Tg"; depth:4; content:"|05 00 02 00|"; within:4; distance:6; isdataat:400,relative; metadata:policy security-ips drop; reference:cve,2011-1563; classtype:attempted-user; sid:24477; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA DATAC RealWin System buffer overflow attempt"; flow:to_server,established; content:"|10 23|Tg"; depth:4; content:"|05 00 05 00|"; within:4; distance:6; isdataat:400,relative; metadata:policy security-ips drop; reference:cve,2011-1563; classtype:attempted-user; sid:24478; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Sinapsi SQL hard coded user login attempt"; flow:to_server,established; content:"/login.php"; fast_pattern:only; http_uri; content:"astridservice"; http_client_body; metadata:service http; reference:url,www.exploit-db.com/exploits/21273/; classtype:web-application-attack; sid:24423; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA DATAC RealWin System buffer overflow attempt"; flow:to_server,established; content:"|10 23|Tg"; depth:4; byte_test:4,>,4096,0,relative,little; content:"|09 00 12 00|"; within:4; distance:6; metadata:policy security-ips drop; reference:cve,2011-1563; classtype:attempted-user; sid:24479; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Sinapsi SQL hard coded user login attempt"; flow:to_server,established; content:"/login.php"; fast_pattern:only; http_uri; content:"36e44c9b64"; http_client_body; metadata:service http; reference:url,www.exploit-db.com/exploits/21273/; classtype:web-application-attack; sid:24424; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Sinapsi SQL injection attempt"; flow:to_server,established; content:"/dettagliinverter.php"; fast_pattern:only; http_uri; pcre:"/[?&]inverterselect=[^&]+?([\x22\x27]|SELECT|UPDATE|INSERT)/Ui"; metadata:service http; reference:url,www.exploit-db.com/exploits/21273/; classtype:web-application-attack; sid:24421; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 777 (msg:"SCADA WellinTech Kingview HMI history server buffer overflow attempt"; flow:to_server,established; content:"|03 00 00|"; depth:3; offset:2; byte_test:2,>,9,0,little; byte_extract:2,4,element_count,relative,little,multiplier 12; byte_test:2,>,element_count,0,little; reference:cve,2011-4536; reference:url,osvdb.org/77992/; classtype:attempted-admin; sid:24480; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"SCADA DATAC RealWin System buffer overflow attempt"; flow:to_server,established; content:"|10 23|Tg"; depth:4; content:"|05 00 01 00|"; within:4; distance:6; isdataat:400,relative; metadata:policy security-ips drop; reference:cve,2011-1563; classtype:attempted-user; sid:24476; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA Broadwin WebAccess ActiveX function call access"; flow:established,to_server; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; nocase; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=v)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar3>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=n)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar4>\x22|\x27|)(\x25[dlnpsx])+)/smiO"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24582; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA Broadwin WebAccess ActiveX function call access"; flow:established,to_server; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; nocase; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=v)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=n)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)/smiO"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24585; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA Broadwin WebAccess ActiveX clsid access"; flow:established,to_server; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)/siO"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24581; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SCADA Broadwin WebAccess ActiveX clsid access"; flow:established,to_server; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; nocase; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)/siO"; metadata:service smtp; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24584; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SCADA Broadwin WebAccess ActiveX function call access"; flow:established,to_client; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; nocase; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=v)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar3>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=n)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar4>\x22|\x27|)(\x25[dlnpsx])+)/smiO"; metadata:service http, service imap, service pop3; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24580; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SCADA Broadwin WebAccess ActiveX function call access"; flow:established,to_client; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; nocase; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=v)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=n)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)/smiO"; metadata:service http, service imap, service pop3; reference:cve,2012-0242; reference:url,www.exploit-db.com/exploits/17772/; classtype:attempted-user; sid:24583; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5159 (msg:"SCADA GE Proficy Real-Time Information Portal directory traversal attempt"; flow:to_server,established; content:"|43 00 01 00 00 00 0C|"; depth:7; content:"|00 00 00 00 01 00 00 00 01|"; within:9; distance:4; byte_extract:4,0,filename_len,relative; content:"|00 2E 00 2E|"; within:filename_len; distance:4; reference:bugtraq,52439; reference:cve,2012-0232; reference:url,support.ge-ip.com/support/index?page=kbchannel&id=S:KB14768; classtype:attempted-admin; sid:24803; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SCADA Tridium Niagara directory traversal config.bog access attempt"; flow:to_server,established; content:"ord?file|3A 5E|config.bog"; fast_pattern:only; http_uri; metadata:policy security-ips drop, service http; reference:cve,2012-4027; classtype:attempted-admin; sid:25057; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] (msg:"SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|"; depth:4; offset:4; byte_test:4,>,0x800,0,relative,little; metadata:policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25850; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] (msg:"SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|"; depth:4; offset:4; byte_jump:4,0,relative,little,post_offset -4; byte_test:4,>,0x800,0,relative,little; metadata:policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25852; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] (msg:"SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|"; depth:4; offset:4; byte_jump:4,0,relative,little,post_offset -4; byte_test:4,<,0x20,0,relative,little; metadata:policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25851; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] (msg:"SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|"; depth:4; offset:4; byte_test:4,<,0x20,0,relative,little; metadata:policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25849; rev:2;)

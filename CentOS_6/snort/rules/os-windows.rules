# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Explorer invalid url file overflow attempt"; flow:to_client,established; file_data; content:"[InternetShortcut]"; depth:100; nocase; content:"url="; distance:0; nocase; content:"file|3A|file|3A|file|3A|"; distance:0; nocase; metadata:policy security-ips drop, service http; reference:bugtraq,18838; reference:cve,2006-3351; classtype:denial-of-service; sid:7022; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceListSize attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:11; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:4358; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1433 (msg:"OS-WINDOWS MS-SQL convert function unicode overflow"; flow:to_server,established; content:"S|00|E|00|L|00|E|00|C|00|T|00| |00|C|00|O|00|N|00|V|00|E|00|R|00|T|00 28 00|v|00|a|00|r|00|c|00|h|00|a|00|r|00|,|00|c|00|r|00|e|00|a|00|t|00|e|00|d|00|a|00|t|00|e|00|,|00|1|00|2|00|3|00|4|00|5|00|6|00|7|00|8|00|9|00|0|00 29 00| |00|F|00|R|00|O|00|M|00| |00|s|00|y|00|s|00|u|00|s|00|e|00|r|00|s"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:16073; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DirectShow MJPEG arbitrary code execution attempt"; flow:to_client,established; file_data; content:"LISTt|B4 08 00|movi00db@J|00 00 D0 F5|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0084; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-011; classtype:attempted-user; sid:15457; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc LlsrConnect overflow attempt"; flow:established,to_server; dce_iface:342cfd40-3c6c-11ce-a893-08002b2e9c6d; dce_opnum:0; dce_stub_data; byte_test:4,>,52,0,dce; metadata:ruleset community, service netbios-ssn; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-010; classtype:attempted-admin; sid:3114; rev:14;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft CSRSS integer overflow attempt"; flow:to_client,established; file_data; content:"|66 89 4D E6 C7 45 E0 00 00 00 80 8D 55 E0 52 8B 45 E4 50 68 00 00 00 80 8D 4D F8 51 8B 55 DC 52|"; fast_pattern:only; metadata:service http; reference:cve,2011-1870; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-056; classtype:attempted-user; sid:19464; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft XML core services cross-domain information disclosure attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; pcre:"/setRequestHeader.*chunked/smiR"; content:"send"; distance:0; content:"0|5C|r|5C|n|5C|r|5C|n"; distance:0; metadata:policy security-ips drop, service http; reference:cve,2008-4033; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-069; classtype:attempted-recon; sid:19818; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP nddeapi NDdeSetTrustedShareW overflow attempt"; flow:established,to_server; dce_iface:2f5f3220-c126-1076-b549-074d078619da; dce_opnum:12; dce_stub_data; isdataat:256; content:!"|00|"; depth:256; offset:12; metadata:ruleset community, service netbios-ssn; reference:bugtraq,11372; reference:cve,2004-0206; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-031; classtype:attempted-admin; sid:2936; rev:17;)
# alert udp $HOME_NET any -> $HOME_NET [138,139] (msg:"OS-WINDOWS Microsoft Windows 2003 browser election remote heap overflow attempt"; content:"|5C|MAILSLOT|5C|"; nocase; content:"|00 08|"; distance:0; pcre:"/\x5cMAILSLOT\x5c[^\x00]*\x00\x08.{13}[^\x00]{56}/si"; metadata:policy security-ips drop; reference:bugtraq,46360; reference:cve,2011-0654; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-019; classtype:attempted-admin; sid:18994; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans unicode andx Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; metadata:service netbios-ssn; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5724; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player directory traversal via Content-Disposition attempt"; flow:to_client,established; content:".wmz"; fast_pattern; nocase; http_header; content:"Content-Disposition|3A|"; nocase; http_header; content:"filename="; nocase; http_header; pcre:"/filename=[^\x3b\x3a\r\n]*(\x25\x2e\x25\x2e\x25\x5c|\x25\x32\x65\x25\x35\x63|\x2e\x2e\x5c)[^\x3b\x3a\r\n]*\x2ewmz/smiH"; metadata:ruleset community, service http; reference:bugtraq,7517; reference:cve,2003-0228; reference:nessus,11595; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-017; classtype:attempted-user; sid:3192; rev:19;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB Negotiate Protocol Response overflow attempt"; flow:to_client,established; content:"|FF|SMBr"; depth:5; offset:4; content:"|11|"; within:1; distance:27; byte_test:4,<,32,7,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-0016; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-006; classtype:attempted-admin; sid:16417; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Search andx Search filename size integer underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|81|"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4000,5,little,relative; metadata:service netbios-ssn; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14653; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15199; rev:9;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CryptoAPI common name spoofing attempt"; flow:to_client,established; ssl_state:server_hello; content:"|55 04 03 13|"; byte_extract:1,0,namelen,relative; content:"|00|"; within:namelen; metadata:policy security-ips drop, service ssl; reference:cve,2009-2510; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-056; classtype:misc-attack; sid:24490; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB unicode andx invalid server name share access"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"u"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,7,little,relative; content:"|5C 00 5C 00|"; distance:2; nocase; pcre:!"/^([^\x5C\x00].|[\x5c\x00][^\x00])+\x5C\x00/sR"; metadata:service netbios-ssn; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16399; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15205; rev:9;)
# alert tcp any [137,139] -> $HOME_NET any (msg:"OS-WINDOWS SMB Microsoft Windows RAP API NetServerEnum2 long server name buffer overflow attempt"; flow:to_client,established; flowbits:isset,netsenum; content:"|EA 00|"; depth:2; offset:60; isdataat:22; content:!"|00|"; within:16; distance:6; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,54940; reference:cve,2012-1853; reference:url,osvdb.org/84601; reference:url,technet.microsoft.com/security/bulletin/MS12-054; classtype:attempted-dos; sid:24007; rev:2;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msqueue function 4 overflow attempt"; dce_iface:975201B0-59CA-11D0-A8D5-00A0C90D8051; dce_opnum:4; dce_stub_data; byte_test:4,>,128,8,dce; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service dcerpc; reference:cve,2005-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:3171; rev:13;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"OS-WINDOWS Microsoft Windows wpad dynamic update request "; flow:to_server; content:"|06|isatap"; byte_test:1, &, 8, 2; byte_test:1, &, 32, 2; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dns; reference:cve,2009-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-008; classtype:attempted-admin; sid:17731; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [2300:2400] (msg:"OS-WINDOWS Microsoft Windows DirectX IDirectPlay4 denial of service attempt"; flow:to_server; content:"play"; depth:4; content:"|2D 00 0B 00|"; within:4; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:4; content:!"|18 00 00 00|"; within:4; reference:cve,2004-0202; classtype:attempted-dos; sid:23437; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Rename invalid buffer type attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8458; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft WebDAV PROPFIND request"; flow:to_server,established; content:"PROPFIND"; http_method; content:"User-Agent: Microsoft-WebDAV"; fast_pattern:only; http_header; flowbits:set,ms.webdav.propfind; flowbits:noalert; metadata:service http; classtype:misc-activity; sid:24089; rev:3;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS NAPTR remote unauthenticated code execution vulnerability attempt"; flow:to_client; content:"|00 23 00 01|"; depth:10; offset:34; byte_test:1,&,0x80,2; byte_test:2,!&,0x7a0f,2; pcre:"/^.{28}\x00[\xff\x23]\x00\x01(.{2}|.{8})\x00\x23\x00\x01/"; byte_jump:1,10,relative; byte_jump:1,0,relative; byte_test:1,>,128,0,relative; metadata:policy security-ips drop, service dns; reference:cve,2011-1966; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-058; classtype:attempted-admin; sid:19677; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW overflow attempt"; flow:established,to_server; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-051; classtype:attempted-admin; sid:4245; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15133; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrJoinDomain2 overflow attempt"; flow:established,to_server; dce_iface:6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:22; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; content:"|5C 00|"; distance:12; content:!"|00 00|"; within:256; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2006-4691; reference:nessus,11921; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-070; classtype:attempted-admin; sid:9027; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMDeleteObject overflow attempt"; flow:established,to_server; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:9; dce_stub_data; content:"|01 00 00 00|"; depth:4; offset:4; content:"|03 00 00 00|"; within:4; distance:4; byte_test:4,>,214,8,relative,dce; metadata:policy security-ips alert, service dcerpc; reference:cve,2005-0059; reference:nessus,18027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:3590; rev:17;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 (msg:"OS-WINDOWS Microsoft Windows PPTP Start Control Request buffer overflow attempt"; flow:to_server,established,no_stream; isdataat:156; content:"|00 01|"; depth:2; offset:2; content:"|00 01|"; depth:2; offset:8; metadata:ruleset community; reference:bugtraq,5807; reference:cve,2002-1214; reference:nessus,11178; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-063; classtype:attempted-admin; sid:2126; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft client for netware overflow attempt"; flow:to_server,established; dce_iface:e67ab081-9844-3521-9d32-834f038001c0; dce_opnum:9; dce_stub_data; content:"|5C 00 5C 00|"; pcre:"/^(B\x00B\x00B\x00|\x41\x41\x41\x41)/R"; metadata:service netbios-ssn; reference:cve,2006-4688; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-066; classtype:attempted-admin; sid:16016; rev:9;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Search unicode andx Search filename size integer underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|81|"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4000,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14652; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15215; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMCreateObjectInternal overflow attempt"; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:6; dce_stub_data; byte_test:4,=,1,0,dce; byte_test:4,>,142,4,dce; metadata:service dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:12978; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows URI External handler arbitrary command attempt"; flow:to_client,established; content:"%00%00"; pcre:"/(mailto|telnet|news|nntp|snews)\x3A%00%00/i"; metadata:service http; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-061; classtype:attempted-user; sid:12643; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"build.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24132; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; metadata:service netbios-ssn; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5730; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP lsass DsRolerGetPrimaryDomainInformation attempt"; flow:established,to_server; dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:0; metadata:service netbios-ssn; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:protocol-command-decode; sid:5095; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Media Player and shell extension ehtrace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ehtrace.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0032; reference:cve,2011-2009; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-076; classtype:attempted-user; sid:18496; rev:8;)
alert udp $EXTERNAL_NET any -> $HOME_NET [138,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP srvsvc NetrpPathCanonicalize path canonicalization stack overflow attempt"; dce_iface:4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:31,32; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/\x00\.\x00\.\x00[\x2f\x5c]/R"; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-067; classtype:attempted-admin; sid:14783; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans andx Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; metadata:service netbios-ssn; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5736; rev:11;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS server spoofing attempt"; flow:to_client; content:"|03|www|07|example|03|com|00 00 01 00 01 C0 0C 00 01 00 01 00 00 0E 10 00 04|****"; fast_pattern:only; metadata:policy security-ips drop, service dns; reference:bugtraq,25919; reference:cve,2007-3898; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-062; classtype:misc-attack; sid:16206; rev:5;)
# alert udp $HOME_NET 138 -> $HOME_NET 138 (msg:"OS-WINDOWS Microsoft Windows 2003 browser election remote heap overflow attempt"; content:"|5C|MAILSLOT|5C|BROWSER|00 08 09|"; content:"|00 00 00 00|"; within:4; distance:8; isdataat:15,relative; content:!"|00|"; within:15; metadata:policy security-ips drop; reference:bugtraq,46360; reference:cve,2011-0654; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-019; classtype:attempted-admin; sid:18462; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Data Access Components bidlab.dll dll-load exploit attempt"; flow:to_server,established; content:"b|00|i|00|d|00|l|00|a|00|b|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-1975; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-059; classtype:attempted-user; sid:19673; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Encoder 9 ActiveX buffer overflow attempt"; flow:to_client,established; file_data; content:"unescape|28|'"; content:"GetDetailsString|28|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3008; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-053; classtype:attempted-user; sid:16578; rev:5;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB2 client NetBufferList NULL entry remote code execution attempt"; flow:to_client,established; content:"|00 00 FF FF FE|SMB@|00|"; depth:10; isdataat:130,relative; content:"|01 00|"; within:2; distance:6; content:"|A0 00 00 00|"; within:4; distance:6; content:"H|00 04 01|"; within:4; distance:44; content:"AAAAAAAA"; within:8; distance:56; metadata:policy security-ips alert, service netbios-ssn; reference:cve,2010-0477; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-020; classtype:attempted-admin; sid:23237; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15127; rev:6;)
# alert udp any any -> any 67 (msg:"OS-WINDOWS Microsoft Windows NT DHCP REQUEST hostname overflow attempt"; flow:to_server; content:"|63 82 53 63|"; depth:4; offset:236; content:"|35 01 03|"; within:3; content:"|0C|"; distance:0; byte_test:1,>,150,0,relative; isdataat:150,relative; reference:bugtraq,11920; reference:cve,2004-0899; classtype:attempted-dos; sid:23231; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans unicode andx mailslot heap overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|03|"; within:1; distance:27; content:!"|00 00|"; within:50; distance:9; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7040; rev:13;)
# alert tcp any [137,139] -> $HOME_NET any (msg:"OS-WINDOWS SMB Microsoft Windows RAP API NetServerEnum2 long comment buffer overflow attempt"; flow:established,to_client; content:"|FF|SMB|25 00 00 00 00|"; depth:9; offset:4; byte_test:1,&,0x80,0,relative; byte_jump:2,51,relative,multiplier 26,little,post_offset 2; isdataat:32,relative; pcre:"/[^\x00]{32}/R"; metadata:service netbios-ssn; reference:cve,2012-1852; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-054; classtype:attempted-admin; sid:24336; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows .NET framework optimizer escalation attempt"; flow:to_client,established; file_data; content:"|00|Program|00|Big|00|Misaligned|00|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3958; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-028; classtype:attempted-user; sid:18624; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows winhelp clsid attempt"; flow:to_client,established; file_data; content:"adb880a6-d8ff-11cf-9377-00aa003b7a11"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*adb880a6-d8ff-11cf-9377-00aa003b7a11/si"; metadata:policy security-ips drop, ruleset community, service http; reference:bugtraq,11467; reference:bugtraq,4857; reference:bugtraq,5874; reference:cve,2002-0693; reference:cve,2002-0823; reference:cve,2004-1043; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB828750; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;Q293338; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-055; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-001; reference:url,www.ngssoftware.com/advisories/ms-winhlp.txt; classtype:attempted-user; sid:3148; rev:17;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CSRSS double free attempt"; flow:to_client,established; file_data; content:"|4A 10 33 C0 8B 4D FC 66 89 41 16 33 D2 8B 45 FC 66 89 50 12 8B 4D FC C7 41 0C 11 14 14 14 6A 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-1284; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-056; classtype:attempted-user; sid:19463; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans mailslot heap overflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|03|"; within:1; distance:27; content:"|01 00 00 00|"; within:4; distance:1; content:!"|00|"; within:25; distance:4; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7037; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DirectShow MJPEG arbitrary code execution attempt"; flow:to_client,established; file_data; content:"LIST|A0 84 01 00|movi00dc|E3 02 00 00 D0 D8|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0084; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-011; classtype:attempted-user; sid:16187; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX andx attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15135; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans unicode Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; metadata:service netbios-ssn; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5718; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Address Book smmscrpt.dll malicious DLL load"; flow:to_server,established; content:"smmscrpt.dll"; nocase; http_uri; metadata:policy security-ips drop, service http; reference:cve,2010-3144; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-097; classtype:attempted-user; sid:18202; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows AFD.SYS null write attempt"; flow:to_client,established; file_data; content:"|6A 18 50 68 AB 80 40 00 89 BD B0 FC FF FF 89 B5 B8 FC FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-046; classtype:attempted-admin; sid:18691; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Lync Online wlanapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"w|00|l|00|a|00|n|00|a|00|p|00|i|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-1849; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; classtype:attempted-user; sid:23163; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans Max Param OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5728; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft ForeFront UAG ExcelTable.asp XSS attempt"; flow:to_server,established; content:"ExcelTable.asp"; fast_pattern:only; http_uri; content:"tableData="; nocase; http_client_body; pcre:"/^[^\&\r\n]*[<\(][^\&\r\n]+[\)>]/R"; metadata:service http; reference:cve,2011-1896; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-user; sid:20257; rev:7;)
alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Movie Maker hhctrl.ocx dll-load exploit attempt"; flow:to_client,established; content:"h|00|h|00|c|00|t|00|r|00|l|00|.|00|o|00|c|00|x|00|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-3967; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-093; classtype:attempted-user; sid:18211; rev:5;)
# alert udp any any -> $HOME_NET 69 (msg:"OS-WINDOWS TFTP PUT Microsoft RIS filename overwrite attempt"; flow:to_server; content:"|00 02|"; depth:2; content:"setup.exe|00|"; distance:0; nocase; reference:cve,2006-5584; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-077; classtype:policy-violation; sid:17712; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans andx Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5721; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB unicode andx invalid server name share access"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"u"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,7,little,relative; content:"|5C 00 5C 00|"; distance:2; nocase; pcre:!"/^([^\x5C\x00].|[\x5c\x00][^\x00])+\x5C\x00/sR"; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16403; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; pcre:!"/^.{8}(\x05\x37(\x1E[\x90-\xFF]|[\x1F-\x2F].|\x30[\x00-\x70])|\x00\x00\x00[\x00-\x65]|\x02\x68\x05\xC0)/s"; metadata:ruleset community, service wins; reference:bugtraq,11763; reference:cve,2004-0567; reference:cve,2004-1080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-045; reference:url,www.immunitysec.com/downloads/instantanea.pdf; classtype:misc-attack; sid:3017; rev:16;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Media Encoder winietenu.dll dll-load exploit attempt"; flow:to_server,established; content:"w|00|i|00|n|00|i|00|e|00|t|00|e|00|n|00|u|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18226; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15140; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product news uri handling code execution attempt"; flow:to_client,established; file_data; content:"news|3A|"; nocase; pcre:"/^[^\n]*?(\x2E(com|bat|cmd|exe)((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5c)00)/Ri"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:13270; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS Messenger message little endian overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; byte_jump:4,18,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,8,little,relative; metadata:ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:3234; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msqueue function 4 overflow attempt"; flow:established,to_server; dce_iface:975201B0-59CA-11D0-A8D5-00A0C90D8051; dce_opnum:4; dce_stub_data; byte_test:4,>,128,8,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2005-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:9769; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 4|0A|"; depth:7; metadata:service http; reference:cve,2010-2561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-051; classtype:attempted-dos; sid:18962; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15212; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows 2000 Kodak Imaging small offset malformed jpeg tables"; flow:to_client,established; file_data; content:"|0D 0A FF D8|"; content:"|FF DB|"; distance:0; byte_test:2, =, 0, 2, relative; metadata:service http; reference:cve,2007-2217; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; classtype:attempted-user; sid:12631; rev:9;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft ISA Server DNS spoofing attempt"; flow:to_client; content:"|C0 0C 00 0C 00 01 00 01|Q|80 00 0F 03|www|05|yahoo|03|com|00|"; metadata:service dns; reference:bugtraq,11605; reference:cve,2004-0892; classtype:misc-attack; sid:15988; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_DetectResourceConflict attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:53; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,32,16,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,14513; reference:cve,2005-1983; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-039; classtype:protocol-command-decode; sid:4072; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Hypervisor OS-WINDOWS vfd download attempt"; flow:to_client,established; file_data; content:"|29 66 3A E1 58 4E 4F 20 4E 41 4D 45 20 20 20 20 46 41 54 31 32 20 20 20 6A 00|"; fast_pattern:only; metadata:service http; reference:cve,2010-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-010; classtype:attempted-admin; sid:18396; rev:9;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB client TRANS response Find_First2 filename overflow attempt"; flow:to_client,established; flowbits:isset,smb.trans2.findfirst2; content:"|FF|SMB2|00 00 00 00|"; depth:9; offset:4; byte_test:3,>,135,-12,relative,big; byte_test:1,&,128,0,relative; flowbits:unset,smb.trans2.findfirst2; content:"|00 00|"; within:2; distance:13; content:"|00 00|"; within:2; distance:13; content:"|00|"; within:1; distance:13; content:"|00|"; within:1; distance:2; content:"|FF FF FF FF|"; within:4; distance:72; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:attempted-admin; sid:17746; rev:10;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContext heap overflow attempt"; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:1; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,<,37,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17906; reference:cve,2006-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6456; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Expression Design wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wintab32.dll"; nocase; http_uri; metadata:service http; reference:cve,2012-0016; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-022; classtype:attempted-user; sid:21567; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Forefront UAG URL XSS alternate attempt"; flow:to_server, established; content:"signurl|2E|asp"; fast_pattern; nocase; http_uri; content:"SignUrl="; nocase; http_uri; pcre:"/SignUrl=[^\x26\s]*[\x22\x27\x28\x29\x3C\x3E]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3936; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:attempted-admin; sid:18076; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrValidateName2 overflow attempt"; flow:established,to_server; dce_iface:6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:25; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:service netbios-ssn; reference:bugtraq,9011; reference:cve,2003-0812; reference:nessus,11921; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-049; classtype:attempted-admin; sid:18315; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceList attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:10; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:4334; rev:12;)
# alert tcp $EXTERNAL_NET 3389 -> $HOME_NET any (msg:"OS-WINDOWS Remote Desktop orderType remote code execution attempt"; flow:to_client,established; byte_jump:1,4; content:"|17 00|"; within:2; distance:14; content:"|00 00|"; within:2; distance:14; byte_test:1,&,3,6,relative; byte_test:1,>,7,11,relative; reference:cve,2009-1133; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-044; classtype:attempted-user; sid:15850; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMGetRemoteQueueName overflow attempt"; flow:established,to_server; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:1; dce_stub_data; isdataat:16; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2008-3479; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-065; classtype:attempted-admin; sid:14725; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 1|0A|"; depth:7; metadata:service http; reference:cve,2010-2561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-051; classtype:attempted-dos; sid:17133; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"view.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24135; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 514 (msg:"OS-WINDOWS Microsoft Windows RSH daemon buffer overflow attempt"; flow:established,to_server; isdataat:1032; content:"|00|"; depth:1; content:"|00|"; within:1; distance:1; content:"|00|"; within:1; distance:1; reference:cve,2007-4005; reference:cve,2007-4006; classtype:attempted-admin; sid:20603; rev:3;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB-DS Trans2 Distributed File System response PathConsumed integer overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2.get_dfs_referral; content:"|00|"; offset:1; content:"|FF|SMB2"; depth:5; offset:4; content:"|00 00 00 00|"; within:4; content:"|01 00|"; within:2; distance:55; content:"|01 00|"; within:2; distance:2; pcre:"/^.{2}\x5c\x00[^\x5c]*\x00\x00/R"; flowbits:unset,smb.trans2.get_dfs_referral; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2011-1868; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-042; classtype:attempted-admin; sid:19221; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS Messenger message overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,!&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; byte_jump:4,18,align,relative; byte_jump:4,8,align,relative; byte_test:4,>,1024,8,relative; metadata:ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:3235; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows malformed ASF voice codec memory corruption attempt"; flow:to_client,established; file_data; content:"@|9E|i|F8|M[|CF 11 A8 FD 00 80|_|5C|D+"; isdataat:46,relative; pcre:"/^.{38}\x0a\x00..(?!(\x40\x1f|\x11\x2b|\x80\x3e|\x22\x56)\x00\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-0555; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-051; classtype:attempted-user; sid:16157; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function unicode attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15142; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft SilverLight ImageSource remote code execution attempt"; flow:to_client,established; flowbits:isset,imagesource.redefine; file_data; content:"ImageBrush"; content:"ImageSource"; distance:0; pcre:"/ImageBrush[^\x3e]+ImageSource\s*\x3d\s*(\x22|\x27)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0019; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-060; classtype:attempted-user; sid:17114; rev:8;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Foundation Class applications mfc80.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|8|00|0|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18627; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Forefront UAG NLSessionS cookie overflow attempt"; flow:established,to_server; content:"NLSessionS"; pcre:"/(NLSessionS[^=\s]*)\s*=\s*\x3B.*\1\s*=[^\s\x3B]/C"; metadata:service http; reference:cve,2011-2012; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-dos; sid:20272; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContextW overflow attempt"; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-051; classtype:attempted-admin; sid:4246; rev:12;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Visual Studio MFC applications mfc90.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc90.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18622; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans unicode mailslot heap overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|03|"; within:1; distance:27; content:!"|00 00|"; within:50; distance:9; metadata:service netbios-ssn; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7036; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows javascript arguments keyword override rce attempt"; flow:to_client,established; file_data; content:"function arguments"; fast_pattern:only; pcre:"/function arguments\s*\x28[^\x29]*\x29\s*\x7b/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1920; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-045; classtype:attempted-user; sid:15913; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player ASF simple index object parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.asf; file_data; content:"|90 08 00 33 B1 E5 CF 11 89 F4 00 A0 C9 03 49 CB|"; byte_test:4,>,715827882,36,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-052; classtype:attempted-user; sid:9641; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Rename invalid buffer type andx attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; metadata:service netbios-ssn; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8453; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function andx attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15139; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MMC createcab.cmd cross site scripting attempt"; flow:to_client,established; file_data; content:"res|3A|//createcab.cmd"; metadata:service http; reference:bugtraq,19417; reference:cve,2006-3643; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-044; classtype:attempted-user; sid:7424; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Session Setup NTMLSSP unicode andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3002; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceListSize attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:11; dce_stub_data; content:"|5C 5C|"; offset:16; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:17438; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Forefront UAG external redirect attempt"; flow:to_server,established; content:"|2F|redir|2E|asp|3F|"; nocase; http_uri; content:"TARGET|3D|"; nocase; http_uri; content:"Host|3A|"; http_header; pcre:"/\x2fredir\x2easp\x3f[^\s]*TARGET\x3d(\w{3,6}\x3a\x2f\x2f)?[^\x26\x3d\x2f\x20]*([a-z0-9\x2d]+\x2e[a-z0-9\x2d]+)[\x2f\x20\x26].*^Host\x3a/Osmi"; isdataat:10,relative; pcre:!"/\x2fredir\x2easp\x3f[^\s]*TARGET\x3d(\w{3,6}\x3a\x2f\x2f)?[^\x26\x3d\x2f\x20]*([a-z0-9\x2d]+\x2e[a-z0-9\x2d]+)[\x2f\x20\x26].*^Host\x3a[^\n]*\1/Osmi"; metadata:service http; reference:cve,2010-2732; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:policy-violation; sid:18072; rev:8;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Groove mso.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|s|00|o|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-016; classtype:attempted-user; sid:18500; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; file_data; content:"gXYZ"; content:"gXYZ"; within:4; distance:8; content:"bXYZ"; within:4; distance:8; byte_test:4,>,60,4,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17348; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Color Control Panel STI.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|STI.dll"; fast_pattern:only; http_uri; metadata:service http; reference:cve,2010-5082; reference:url,osvdb.org/68918; reference:url,shinnai.altervista.org/exploits/SH-006-20100914.html; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-012; classtype:attempted-user; sid:21290; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [1027:1050] (msg:"OS-WINDOWS Microsoft Windows WINS internal communications on network exploit attempt"; flow:to_server; dsize:24; content:"|00 00 00|"; depth:3; offset:1; byte_test:1,<,2,0; detection_filter:track by_src,count 10, seconds 2; reference:cve,2011-1984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-070; classtype:attempted-user; sid:20120; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1958 (msg:"OS-WINDOWS malicious ASP file upload attempt"; flow:to_server,established; content:"<!--|23|include file=|22 61 61 61 61 61 61 61 61|"; fast_pattern:only; reference:bugtraq,18858; reference:cve,2006-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-034; classtype:attempted-user; sid:17724; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB startup folder access"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB2"; depth:5; offset:4; content:"Documents and Settings|5C|All Users|5C|Start Menu|5C|Programs|5C|Startup|00|"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; classtype:attempted-recon; sid:2176; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode andx max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15219; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS SMBv2 protocol negotiation attempt"; flow:to_server,established; byte_test:1,>,0xFD,4; content:"SMBr"; depth:4; offset:5; content:"|02|SMB 2.001|00|"; offset:36; metadata:policy security-ips alert, service netbios-ssn; reference:cve,2007-5351; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-063; classtype:attempted-admin; sid:12946; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Negotiate SSP buffer overflow attempt"; flow:to_server,established; content:"Authorization|3A|"; nocase; http_header; content:"Negotiate"; within:20; nocase; http_header; content:"YIIAEwYGKwYBBQUCoAkwB6EFIwMDAQc=|0D 0A|"; fast_pattern:only; http_header; metadata:policy security-ips drop, service http; reference:bugtraq,10113; reference:cve,2004-0119; classtype:attempted-admin; sid:15996; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Address Book wab32res.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"w|00|a|00|b|00|3|00|2|00|r|00|e|00|s|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-085; classtype:attempted-user; sid:18206; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC ISystemActivate flood attempt"; flow:to_server,established; content:"|00|"; depth:1; offset:2; dce_iface:000001a0-0000-0000-c000-000000000046; dce_stub_data; content:"MEOW"; detection_filter:track by_src, count 100, seconds 5; metadata:service netbios-ssn; reference:bugtraq,8811; reference:cve,2003-0813; reference:nessus,12206; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-012; classtype:protocol-command-decode; sid:21262; rev:4;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft invalid message kernel-mode memory disclosure attempt"; flow:to_client,established; file_data; content:"|79 29 00 00 E9 D8 38 00 00 E9 E0 11 00 00 E9 5E 72 00 00 E9 99 71 00 00 E9 47 31 00 00 E9 55 6E 00 00 E9 A9 57 00 00 E9 CC 37 00 00 E9 AB 9C 00|"; fast_pattern:only; metadata:service http; reference:cve,2011-1886; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-054; classtype:attempted-user; sid:19469; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 andx param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15226; rev:8;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP ISystemActivator RemoteCreateInstance attempt"; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:4; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|"; distance:0; byte_test:4,>,256,-8,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service dcerpc; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:3398; rev:15;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft products oleacc.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|oleacc.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-1247; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-075; classtype:attempted-user; sid:20254; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP ISystemActivator CoGetInstanceFromFile attempt"; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:1; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|"; distance:0; byte_test:4,>,256,-8,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service dcerpc; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-039; classtype:protocol-command-decode; sid:3159; rev:15;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 andx max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15216; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Jet DB Engine Buffer Overflow attempt"; flow:to_client,established; file_data; content:"P|00|a|00|r|00|e|00|n|00|t|00|I|00|d|00|n|00|a|00|m|00|e|00 75 76|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,12960; reference:cve,2005-0944; classtype:attempted-user; sid:17413; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Data Access Components bidlab.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|bidlab.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-1975; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-059; classtype:attempted-user; sid:19674; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS DCERPC Messenger Service buffer overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-043; classtype:attempted-admin; sid:2257; rev:14;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,138,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP lsass DsRolerUpgradeDownlevelServer overflow attempt"; dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:9; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service netbios-dgm; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2511; rev:20;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; file_data; content:"|62 69 6E EC 56 5B 6F 1B 45 14 1E BB 84 92 B4 A5 17 A0 2D E5 B6 DD 42 B9 54 DE F5 DA A8 17 CB|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:21506; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product mailto uri handling code execution attempt"; flow:to_client,established; file_data; content:"mailto|3A|"; nocase; content:"|2E|bat"; within:500; nocase; pcre:"/mailto\x3A[^\n]*?(\x2Ebat((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5cx)00)/i"; metadata:service http, service imap, service pop3; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:cve,2007-5020; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; classtype:attempted-user; sid:18171; rev:6;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS Smb2Create_Finalize malformed EndOfFile field exploit attempt"; flow:established,to_client; content:"|FE|SMB|40 00|"; nocase; content:"|05 00|"; within:2; distance:6; byte_test:1,>,0x80,105,relative; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2011-1268; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-043; classtype:attempted-admin; sid:19199; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CSRSS multiple consoles on a single process attempt"; flow:to_client,established; file_data; content:"|50 92 40 00 E8 8E 04 00 00 83 C0 40 50 E8 F9 03 00 00 83 C4 0C 6A 01 E8 87 03 00 00 68 9C 92 40|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1281; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-056; classtype:attempted-user; sid:19460; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS Microsoft ISA and Forefront Threat Management Web Proxy TCP Listener denial of service attempt"; flow:to_server,established; seq:3927875496; flags:R; metadata:service http; reference:bugtraq,34414; reference:cve,2009-0077; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-016; classtype:attempted-dos; sid:16221; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Media Encoder wmerrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wmerrorenu.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18222; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W"; within:16; distance:29; tag:session,5,packets; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2252; rev:20;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMObjectPathToObjectFormat overflow attempt"; flow:established,to_server; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:12; dce_stub_data; byte_test:4,>,142,0,dce; metadata:service dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:13210; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; file_data; content:"url|28|data|3A|font|2F|ttf|3B|"; content:"base64|2C|AAEAAAAT"; within:15; content:"A2hMVFNI5UGsngAA"; within:16; distance:48; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2738; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-063; classtype:attempted-user; sid:17256; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP locator nsi_binding_lookup_begin overflow attempt"; dce_iface:d3fbb514-0e3b-11cb-8fad-08002b1d29c3; dce_opnum:0; dce_stub_data; byte_test:4,>,256,8,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,6666; reference:cve,2003-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-001; classtype:attempted-admin; sid:4755; rev:10;)
# alert tcp $EXTERNAL_NET [138,139] -> $HOME_NET any (msg:"OS-WINDOWS SMB NetServerEnum response host format string exploit attempt"; flow:to_client,established; content:"|00|"; depth:1; content:"|FF|SMB%|00 00 00 00|"; within:9; distance:3; content:"|00 00|"; within:2; distance:47; content:"%"; within:1000; distance:6; pcre:"/^(\d+\x24)?(\d+)?[nxcsd]/iR"; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2012-1851; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-054; classtype:attempted-admin; sid:23838; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP irot IrotIsRunning/Revoke overflow attempt"; flow:established,to_server; dce_iface:b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:1,2; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,align,dce; byte_test:4,>,1024,0,relative,dce; metadata:ruleset community; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-010; classtype:attempted-admin; sid:3238; rev:14;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP irot IrotIsRunning/Revoke overflow attempt"; dce_iface:b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:1,2; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,align,dce; byte_test:4,>,1024,0,relative,dce; metadata:ruleset community; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-010; classtype:attempted-admin; sid:3239; rev:14;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS name query overflow attempt UDP"; flow:to_server; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; metadata:ruleset community; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-006; classtype:attempted-admin; sid:3200; rev:12;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1478 (msg:"OS-WINDOWS Microsoft Windows Host Integration Server SNA length dos attempt"; flow:to_server; content:"|01|"; depth:1; offset:2; byte_test:2,>,16,55,little; reference:cve,2011-2007; reference:cve,2011-2008; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-082; classtype:attempted-dos; sid:20271; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Rename invalid buffer type andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8457; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans andx mailslot heap overflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|03|"; within:1; distance:27; content:"|01 00 00 00|"; within:4; distance:1; content:!"|00|"; within:25; distance:4; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7041; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Rename invalid buffer type unicode andx attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8451; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode Max Param/Count OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5720; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5000 (msg:"OS-WINDOWS Microsoft Windows UPnP malformed advertisement"; flow:to_server,established; content:"NOTIFY * "; fast_pattern:only; reference:bugtraq,3723; reference:cve,2001-0876; reference:cve,2001-0877; reference:nessus,10829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-059; classtype:misc-attack; sid:8082; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Report Viewer reflect XSS attempt"; flow:to_server,established; content:"ReportID|3D|"; nocase; http_uri; content:"ControlID|3D|"; nocase; http_uri; content:"TimerMethod|3D|"; nocase; http_uri; pcre:"/TimerMethod\x3D[^\x26]*[\x3C\x28\x22\x27]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1976; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-067; classtype:attempted-user; sid:19681; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function unicode andx attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15141; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP srvsvc NetrPathCanonicalize overflow attempt"; flow:established,to_server; dce_iface:4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:31; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,19409; reference:cve,2006-3439; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-040; classtype:attempted-admin; sid:7209; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rpcss2_RemoteGetClassObject attempt"; flow:established,to_server; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:3; dce_stub_data; content:"|05 00|"; depth:2; byte_test:2,>,5,0,dce,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:26; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc, service netbios-ssn; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:18267; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15206; rev:9;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-WINDOWS Microsoft Malware Protection Engine file processing denial of service attempt"; flow:to_server,established; content:"|49 44 45 44 38 55 45 47 47 53 39 6F 4F 72 2F 79 6A 45 77 6D 47 4C 76 57 4A 6A 56 4B 6B 6F 6D 6E 78 6E 2F 63 44 45 63 31 50 35|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2008-1437; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-029; classtype:denial-of-service; sid:17306; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Expression Design wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"w|00|i|00|n|00|t|00|a|00|b|00|3|00|2|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0016; reference:url,osvdb.org/80001; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-022; classtype:attempted-user; sid:21566; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [389,3268] (msg:"OS-WINDOWS Microsoft Windows Active Directory crafted LDAP request denial of service attempt"; flow:to_server,established; content:"|04 00 0A 01 00 0A 01 03 02 01|d|02 01|<|01 01 00 A1 0B FF|bjectclass0|84 00 00 00 17 04 15|supportedCapabilities"; metadata:policy balanced-ips drop, policy security-ips drop, service ldap; reference:bugtraq,24796; reference:cve,2007-3028; classtype:attempted-dos; sid:15944; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_server,established; flowbits:isset,file.docm|file.docx|file.ppsx|file.pptx|file.xlsx; flowbits:isset,file.zip; file_data; content:"mx5a0ecw|21|9jX"; fast_pattern:only; metadata:service smtp; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:26067; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Visual Studio Crystal Reports RPT file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|FE FF|"; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; within:16; distance:26; content:!"|01 00 00 00|"; within:4; distance:-20; metadata:service http; reference:bugtraq,21261; reference:cve,2006-6133; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-052; reference:url,www.lssec.com/advisories/LS-20061102.pdf; classtype:attempted-user; sid:12463; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15214; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15128; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 88 (msg:"OS-WINDOWS Microsoft Windows 2000 domain authentication bypass attempt"; flow:to_server; content:"0|17 A0 03 02 01 02 A1 10|0|0E 1B 06|krbtgt|1B 04|A123"; content:"|0F|n|FB C0|"; distance:0; metadata:policy security-ips drop, service kerberos; reference:cve,2004-0540; classtype:attempted-user; sid:15701; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Anti-Cross Site Scripting library bypass attempt"; flow:established,to_client; file_data; content:"style="; nocase; content:"|5C 2C 27|"; within:50; fast_pattern; content:"expression"; within:50; nocase; pcre:"/style\s*=\s*\x22?[^\x22]*?\x5C\x2C\x27[^\x22]+expression\s*\x28/"; metadata:policy security-ips drop, service http; reference:cve,2012-0007; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-007; classtype:attempted-user; sid:20884; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP rpcss _RemoteGetClassObject attempt"; dce_iface:b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:3; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:11074; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Visual Studio MFC applications mfc100.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc100.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18623; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows TCP stack zero window size exploit attempt"; flow:to_server,established; seq:2; ack:1204835598; window:4; flags:A; reference:bugtraq,31545; reference:cve,2008-4609; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-048; classtype:attempted-dos; sid:16294; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player ASX file ref href buffer overflow attempt"; flow:to_client,established; file_data; content:"<ref"; nocase; content:"href"; distance:0; nocase; pcre:"/<ref\s+href\s*=\s*\x22([^\x22]{2}|(\x25[0-9A-Z]{2}){1,2})\x3A\x2F[^\x22]{100}/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,21247; reference:cve,2006-6134; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-078; classtype:attempted-user; sid:9625; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans andx Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; metadata:service netbios-ssn; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5723; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15132; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15198; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft XML substringData integer overflow attempt"; flow:to_client,established; file_data; content:"substringData"; nocase; pcre:"/\w+\.substringData\([^\),]+,\s*(\d{4,}|25[7-9]|2[6-9][0-9]|[3-9][0-9]{2}|0x0*([1-9a-f][1-9a-f]{3,}|[2-9a-f][0-9a-f]{2}|1([0-9a-f][0-9a-f]|0[1-9a-f])))/smi"; metadata:policy security-ips drop, service http; reference:cve,2007-2223; reference:cve,2007-2224; reference:cve,2008-1442; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-043; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-031; classtype:attempted-user; sid:12279; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CSRSS negative array index code execution attempt"; flow:to_client,established; file_data; content:"|45 E0 00 80 00 00 C7 45 E4 0A 00 00 00 C7 45 E8 00 00 00 00 8B F4 8D 45 DC 50 FF 15 A8 81 41 00 3B F4 E8 3A FD FF FF 89 45 F4 8B F4 FF 15 A4 81|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-1283; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-056; classtype:attempted-user; sid:19462; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Lync Online ncrypt.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"n|00|c|00|r|00|y|00|p|00|t|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-1849; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; classtype:attempted-user; sid:23162; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"|00 01 00 00 0E B7 AD 87 5F 0F 3C F5 00 03 03 E8 00 00 00 00 C9 D2 5F 76 00 00 00 00 C9 D2 5F 76 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-user; sid:20073; rev:7;)
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft Windows ASP.NET information disclosure attempt"; flow:to_client,established; file_data; content:"HTTP/1.1 500 Internal Server Error"; fast_pattern:only; detection_filter:track by_dst, count 100, seconds 5; metadata:policy security-ips drop, service http; reference:cve,2010-3332; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-070; classtype:misc-activity; sid:17428; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Forefront UAG javascript handler in URI XSS attempt"; flow:to_server,established; content:"javascript|3A|"; nocase; http_uri; metadata:service http; reference:cve,2011-1897; reference:cve,2012-0017; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-011; classtype:attempted-user; sid:20258; rev:9;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS NAPTR remote unauthenticated code execution vulnerability attempt"; flow:to_client; content:"|C0 0C 00 23 00 01|"; offset:16; byte_test:1,&,0x80,2; byte_test:2,!&,0x7a0f,2; byte_jump:1,10,relative; byte_test:1,>,0x7f,0,relative; metadata:policy security-ips drop, service dns; reference:cve,2011-1966; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-058; classtype:attempted-admin; sid:23950; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Rename invalid buffer type attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; metadata:service netbios-ssn; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8454; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB Trans2 MaxDataCount overflow attempt"; flow:established, to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; content:"|00 00|"; within:2; distance:34; content:"|03 00|"; within:2; distance:20; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2010-2550; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-054; classtype:attempted-admin; sid:17125; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Rename invalid buffer type unicode attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8460; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; metadata:ruleset community; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:2101; rev:21;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows ISA Server cross-site scripting attempt"; flow:to_server,established; content:"CookieAuth.dll"; nocase; http_uri; content:"GetLogonRedir"; distance:0; fast_pattern; nocase; http_uri; content:"formdir="; distance:0; nocase; http_uri; content:"reason="; nocase; http_uri; pcre:"/reason=[^\r\n\x26]+(alert|script|onclick|onload|onmouseover|[\x22\x27\x3c\x3e\x28\x29])/iU"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0237; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-016; classtype:attempted-user; sid:15475; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Vector Markup Language fill method overflow attempt"; flow:to_client,established; file_data; content:"|3A 00|f|00|i|00|l|00|l|00|"; nocase; content:"m|00|e|00|t|00|h|00|o|00|d|00|"; distance:0; nocase; pcre:"/<\x00(\w\x00)+\x3a\x00f\x00i\x00l\x00l\x00\s\x00([^>]\x00|>[^\x00])*m\x00e\x00t\x00h\x00o\x00d\x00(\s\x00)*=\x00(\s\x00)*(\x27\x00([^\x27]\x00|\x27[^\x00]){100}|\x22\x00([^\x22]\x00|\x22[^\x00]){100}|([^\s>]\x00|[\s>][^\x00]){100})/i"; metadata:policy security-ips drop, service http; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-055; classtype:attempted-user; sid:18309; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Session Setup NTMLSSP asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:2382; rev:22;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans unicode Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; metadata:service netbios-ssn; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5731; rev:11;)
# alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Address Book smmscrpt.dll malicious DLL load"; flow:established,to_client; content:"s|00|m|00|m|00|s|00|c|00|r|00|p|00|t|00|.|00|d|00|l|00|l|00|"; nocase; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2010-3144; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-097; classtype:attempted-user; sid:18203; rev:10;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CryptoAPI common name spoofing attempt"; flow:to_client,established; ssl_state:server_hello; content:"|55 04 03 1E|"; byte_extract:1,0,namelen,relative; content:"|00 00|"; within:namelen; metadata:policy security-ips drop, service ssl; reference:cve,2009-2510; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-056; classtype:misc-attack; sid:24488; rev:2;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContextW invalid second uuid size attempt"; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,37,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6432; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Media Encoder asferrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"a|00|s|00|f|00|e|00|r|00|r|00|o|00|r|00|e|00|n|00|u|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18227; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB unicode invalid server name share access"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMBu"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,7,little,relative; content:"|5C 00 5C 00|"; distance:2; nocase; pcre:!"/^([^\x5C\x00].|[\x5c\x00][^\x00])+\x5C\x00/sR"; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16404; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ASF parsing memory corruption attempt"; flow:to_client,established; file_data; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; content:"|91 07 DC B7 B7 A9 CF 11 8E E6 00 C0 0C 20 53 65|"; content:"|E0 7D 90 35 15 E4 CF 11 A9 17 00 80 5F 5C 44 2B|"; byte_test:2,>,0xffc6,52,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2007-0064; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-068; classtype:attempted-user; sid:17711; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15222; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS NT NULL session"; flow:to_server,established; content:"|00 00 00 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|N|00|T|00| |00|1|00|3|00|8|00|1"; metadata:ruleset community; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:530; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"Q.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24131; rev:2;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows OLEAUT32.DLL malicious WMF file remote code execution attempt"; flow:to_client,established; content:"|FF|SMB|2E 00 00 00 00|"; depth:9; offset:4; content:"|6C 74|"; within:6; distance:50; content:"|D7 CD C6 9A 00 00|"; within:6; distance:6; byte_test:4,<,60,-10,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2011-0658; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-038; classtype:attempted-user; sid:19184; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMCreateObjectInternal overflow attempt"; flow:established,to_server; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:6; dce_stub_data; byte_test:4,=,1,0,dce; byte_test:4,>,142,4,dce; metadata:service dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:12977; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows API res buffer overflow attempt"; flow:to_client,established; file_data; content:"res|3A|//"; pcre:"/\x2Edll[\x2F\x5C][^\x3E\x00\s\x2F\x5C]*[\x2F\x5C](\x23|%23)(\d{6}|[7-9]\d{4}|6[6-9]\d{3}|65[6-9]\d{2}|655[4-9]\d|6553[6-9])/smi"; metadata:service http; reference:cve,2007-2219; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-035; classtype:attempted-user; sid:11838; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows embedded web font handling buffer overflow attempt"; flow:to_client,established; file_data; content:"SPP_P|1D CD|P|3B D5 AF AF AF AF 19|6|A5|U4cz{|B1 04 1D E7 EF|jiI|8A|T|D1|s|FD 0C F7|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,16194; reference:cve,2006-0010; classtype:attempted-user; sid:16089; rev:8;)
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows srvsvc NetrShareEnum netname overflow attempt"; flow:to_client,established; content:"y|06 00 00 00 00 00 00|y|06 00 00|A|00|A|00|"; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2009-0228; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-022; classtype:protocol-command-decode; sid:15523; rev:6;)
# alert tcp $HOME_NET 445 -> $EXTERNAL_NET any (msg:"OS-WINDOWS SMB-DS Trans2 FIND_FIRST2 response overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; pcre:"/^.{27}/R"; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:ruleset community, service netbios-ssn; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3145; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft DirectShow QuickTime file atom size parsing heap corruption attempt"; flow:to_client,established; file_data; content:"AAAAAAAA|00 00 00|0stts|04 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1539; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-028; classtype:attempted-user; sid:15680; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP dns R_DnssrvEnumRecords overflow attempt"; flow:established,to_server; dce_iface:50ABC2A4-574D-40B3-9D66-EE4FD5FBA076; dce_opnum:1,3; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,4,relative,dce; metadata:service dcerpc; reference:bugtraq,23470; reference:cve,2007-1748; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-029; classtype:attempted-admin; sid:10900; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Search Search filename size integer underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|81|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,564,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14649; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans andx Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5735; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Session Setup NTMLSSP andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3001; rev:8;)
# alert udp any any -> any 67 (msg:"OS-WINDOWS Microsoft Windows NT DHCP DISCOVER client identifier overflow attempt"; flow:to_server; content:"|63 82 53 63|"; depth:4; offset:236; content:"|35 01 01|"; within:3; content:"|3D|"; distance:0; byte_test:1,>,60,0,relative; isdataat:60,relative; reference:bugtraq,11920; reference:cve,2004-0899; classtype:attempted-dos; sid:23232; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows WebDAV propfind access"; flow:to_server,established; content:"propfind"; nocase; pcre:"/<a\x3a\s*propfind.*?xmlns\x3a\s*a=[\x21\x22]?DAV[\x21\x22]?/iR"; metadata:ruleset community, service http; reference:bugtraq,1656; reference:cve,2000-0869; reference:cve,2003-0718; reference:nessus,10505; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-030; classtype:web-application-activity; sid:1079; rev:24;)
# alert tcp any any -> any 53 (msg:"OS-WINDOWS Microsoft Windows NAT helper components tcp denial of service attempt"; flow:established,to_server; byte_test:2,&,256,2; content:"|00 00 00 00 00 00 00 00|"; depth:8; offset:4; metadata:policy security-ips drop, service dns; reference:cve,2006-5614; classtype:misc-attack; sid:8709; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc2 LlsrLicenseRequestW overflow attempt"; flow:established,to_server; dce_iface:57674CD0-5200-11CE-A897-08002B2E9C6D; dce_opnum:0; dce_stub_data; byte_jump:4,8,multiplier 2,dce; byte_test:4,>,256,16,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; classtype:attempted-admin; sid:16238; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode andx param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15202; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS Microsoft Windows print spooler little endian DoS attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|1A 00|"; within:2; distance:19; pcre:"/^.{20}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,65536,0,little,relative; content:"b|00|l|00|a|00|h|00|_|00|b|00|l|00|a|00|h|00|"; reference:bugtraq,21401; reference:cve,2006-6296; classtype:protocol-command-decode; sid:13594; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW invalid uuid size attempt"; flow:established,to_server; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; byte_test:4,>,37,28,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6419; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP ISystemActivator RemoteCreateInstance attempt"; flow:established,to_server; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:4; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|"; distance:0; byte_test:4,>,256,-8,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:3397; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Outlook Express WAB file parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"|00 00 00 1F 00 11 3A FF FF 0F 00 46 00 6F 00 72 00 6F|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,17459; reference:cve,2006-0014; reference:cve,2006-2386; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-016; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-076; classtype:attempted-user; sid:18590; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rpcss2_RemoteGetClassObject attempt"; flow:established,to_server; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:3; dce_stub_data; content:"|05 00|"; depth:2; byte_test:2,>,5,0,dce,relative; byte_test:4,!,0,26,dce,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:38; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc, service netbios-ssn; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:15512; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans andx Max Param OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5734; rev:10;)
alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMGetRemoteQueueName overflow attempt"; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:1; dce_stub_data; isdataat:16; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2008-3479; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-065; classtype:attempted-admin; sid:14726; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Server driver crafted SMB data denial of service"; flow:to_server,established; content:"|11 00 5C|MAILSLOT|5C|LANMANA"; metadata:service netbios-ssn; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:16066; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode andx max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15209; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Forefront UAG arbitrary embedded scripting attempt"; flow:to_server,established; content:"|2E|asp|3F|"; nocase; http_uri; content:"ONMOUSEOVER|3D 27|"; nocase; http_uri; metadata:policy security-ips drop, service http; reference:cve,2010-2733; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:attempted-user; sid:18073; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function unicode attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15134; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,443,465,993,995] (msg:"OS-WINDOWS PCT Client_Hello overflow attempt"; flow:to_server,established; content:"|01 02 BD 00 01 00 01 00 16 8F|"; depth:10; offset:2; byte_test:2,>,32768,0,relative; metadata:service smtp, service ssl; reference:bugtraq,10116; reference:cve,2003-0719; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:24401; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans Max Param/Count OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5719; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS NVIDIA graphics driver nvsr named pipe buffer overflow attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; depth:9; offset:4; byte_test:1,!&,128,0,relative; content:"|00 00|"; within:2; distance:13; content:"|00|"; within:1; distance:10; content:"|5C 00|n|00|v|00|s|00|r"; within:9; distance:49; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:url,osvdb.org/88745; classtype:attempted-user; sid:25369; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product nntp uri handling code execution attempt"; flow:to_client,established; file_data; content:"nntp|3A|"; nocase; pcre:"/^[^\n]*?(\x2E(com|bat|cmd|exe)((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5c)00)/Ri"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:13269; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [2300:2400] (msg:"OS-WINDOWS Microsoft Windows DirectX IDirectPlay4 denial of service attempt"; flow:to_server,established; content:"play"; depth:4; content:"|2D 00 0B 00|"; within:4; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:4; content:!"|18 00 00 00|"; within:4; reference:cve,2004-0202; classtype:attempted-dos; sid:23436; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Vista Backup Tool fveapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|fveapi.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3145; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-001; classtype:attempted-user; sid:18277; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Session Setup NTMLSSP unicode andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:service netbios-ssn; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3005; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans unicode Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5727; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 andx max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15218; rev:9;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Embedded Package Object packager.exe file load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"p|00|a|00|c|00|k|00|a|00|g|00|e|00|r|00|.|00|e|00|x|00|e|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0009; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-002; classtype:attempted-user; sid:20878; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB SMBv2 protocol negotiation attempt"; flow:to_server,established; byte_test:1,>,0xFD,4; content:"SMBr"; depth:4; offset:5; content:"|02|SMB 2.001|00|"; offset:36; metadata:policy security-ips alert; reference:cve,2007-5351; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-063; classtype:attempted-admin; sid:12947; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Remote Desktop web access cross site scripting attempt - POST request"; flow:to_server,established; content:"/RDWeb/Pages/en-US/login.aspx"; fast_pattern:only; http_uri; content:"ReturnUrl="; nocase; http_client_body; pcre:"/(^|&)ReturnUrl=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|%22|%27|%3C|%3E|%28|%29|%73%63%72%69%70%74|%6f%6e%6c%6f%61%64|%73%72%63|script|onload|src)/Pi"; metadata:policy security-ips drop, service http; reference:cve,2011-1263; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-061; classtype:web-application-attack; sid:25567; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"OS-WINDOWS Microsoft Windows RemoteDesktop new session flood attempt"; flow:to_server,established; content:"|02 F0 80 7F 65|"; content:"|03 00|"; within:2; distance:-9; detection_filter:track by_src,count 10,seconds 3; reference:cve,2012-0002; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-020; classtype:attempted-admin; sid:21570; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [389,3268] (msg:"OS-WINDOWS Microsoft Windows Active Directory Crafted LDAP ModifyRequest"; flow:to_server,established; content:"0|83|"; depth:2; content:"|66 84|"; within:16; byte_test:3,>,0x0F0000,2; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-039; classtype:attempted-admin; sid:20671; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS replication inform2 request memory corruption attempt"; flow:to_server,established; content:"|00 00 00 03 00 00 00 08|"; depth:8; offset:12; byte_test:4,>,65535,0,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ns; reference:cve,2009-1924; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-039; classtype:attempted-admin; sid:17721; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Media Player and shell extension ehtrace.dll dll-load exploit attempt"; flow:to_server,established; content:"e|00|h|00|t|00|r|00|a|00|c|00|e|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0032; reference:cve,2011-2009; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-076; classtype:attempted-user; sid:18497; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 andx param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15225; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; file_data; content:"|62 69 6E EC 55 CD 6E D3 40 10 9E A4 14 A8 69 24 E0 C0 A1 27 2B 27 07 B5 56 12 94 03 91 8A|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:21505; rev:3;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft .NET fully qualified System.Data.dll assembly name exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"S|00|y|00|s|00|t|00|e|00|m|00|.|00|D|00|a|00|t|00|a|00|.|00|d|00|l|00|l|00|,|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-2519; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-074; classtype:attempted-user; sid:24656; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Address Book msoeres32.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|s|00|o|00|e|00|r|00|e|00|s|00|3|00|2|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-085; classtype:attempted-user; sid:18207; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP ISystemActivator CoGetInstanceFromFile attempt"; flow:established,to_server; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:1; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|"; distance:0; byte_test:4,>,256,-8,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-039; classtype:protocol-command-decode; sid:3158; rev:15;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Media Encoder winietenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|winietenu.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18223; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"ann.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24134; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"OS-WINDOWS Microsoft Windows NAT Helper DNS query denial of service attempt"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|00 00|"; depth:2; offset:4; metadata:service dns; reference:bugtraq,20804; reference:cve,2006-5614; classtype:attempted-dos; sid:17294; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMObjectPathToObjectFormat overflow attempt"; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:12; dce_stub_data; byte_test:4,>,142,0,dce; metadata:service dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:13211; rev:15;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft stale data code execution attempt"; flow:to_client,established; file_data; content:"|00 74 02 EB 19 68 00 B0 40 00 E8 1E 01 00 00 83 C4 04 8B 4D 08 51 FF 15 BC CA 40 00 EB 18 8B 55 14 52 8B 45 10 50 8B 4D 0C 51 8B 55 08 52 FF 15|"; fast_pattern:only; metadata:service http; reference:cve,2011-1875; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-054; classtype:attempted-user; sid:19468; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"OS-WINDOWS Microsoft Windows wpad dynamic update request "; flow:to_server; content:"|04|wpad"; byte_test:1, &, 8, 2; byte_test:1, &, 32, 2; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dns; reference:cve,2009-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-008; classtype:attempted-admin; sid:15386; rev:5;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS client ATMA buffer overrun attempt"; flow:to_client; content:"|C0 0C 00 22 00 01 00 00 00|<|00 00 01|"; metadata:policy security-ips drop, service dns; reference:bugtraq,19404; reference:cve,2006-3441; classtype:attempted-admin; sid:16029; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP webdav DavrCreateConnection username overflow attempt"; flow:established,to_server; dce_iface:C8CB7687-E6D3-11D2-A958-00C04F682E16; dce_opnum:0; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,8,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,16636; reference:cve,2006-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-008; classtype:attempted-admin; sid:8253; rev:10;)
alert udp $EXTERNAL_NET any -> $HOME_NET [138,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP srvsvc NetrPathCanonicalize overflow attempt"; dce_iface:4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:31; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-dgm; reference:bugtraq,19409; reference:cve,2006-3439; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-040; classtype:attempted-admin; sid:7210; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5000 (msg:"OS-WINDOWS Microsoft Windows UPnP Location overflow"; flow:to_server,established; content:"Location|3A|"; fast_pattern:only; pcre:"/^Location\:[^\n]{128}/smi"; reference:bugtraq,3723; reference:cve,2001-0876; reference:nessus,10829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-059; classtype:misc-attack; sid:8083; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB2 zero length write attempt"; flow:established, to_server; content:"|FE|SMB|40 00|"; nocase; content:"|09 00|"; within:8; content:"|00 00 00 00|"; within:4; distance:54; metadata:policy security-ips drop; reference:cve,2011-1267; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-048; classtype:attempted-admin; sid:19191; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Vista feed headlines cross-site scripting attack attempt"; flow:to_client,established; file_data; content:"<rss"; content:"<channel"; distance:0; content:"expression|28|"; distance:0; pcre:"/<title>[^>]*?(&lt|<).*?expression\x28.*?<\/title>/i"; metadata:policy security-ips drop, service http; reference:bugtraq,25287; reference:cve,2007-3033; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-048; classtype:web-application-attack; sid:19174; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft XML Core Services cross-site information disclosure attempt"; flow:to_client,established; file_data; content:"<|21|DOCTYPE "; nocase; content:"SYSTEM"; distance:0; nocase; content:".parseError"; distance:0; fast_pattern; nocase; pcre:"/<\x21DOCTYPE\s+[^>]*?SYSTEM[^>]*?>.*?\x2EparseError/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32155; reference:cve,2008-4029; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-069; classtype:attempted-recon; sid:17572; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Visual Studio information disclosure attempt"; flow:to_client,established; file_data; content:"<!ENTITY"; content:"SYSTEM"; within:50; content:"<!ENTITY"; distance:0; content:"SYSTEM"; within:50; content:"http|3A 2F 2F|"; within:100; nocase; pcre:"/\x3C\x21ENTITY\s+(?P<name>\w+)\s+SYSTEM\s+\x22[a-zA-Z]\x3A\x5C.*?\x3C\x21ENTITY\s+\w+\s+SYSTEM\s+\x22[hH][tT]{2}[pP]\x3A\x2f{2}[^\x22]*\x3D\x26(?P=name)/s"; metadata:service http; reference:cve,2011-1280; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-049; classtype:misc-attack; sid:19234; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB unicode invalid server name share access"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBu"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,7,little,relative; content:"|5C 00 5C 00|"; distance:2; nocase; pcre:!"/^([^\x5C\x00].|[\x5c\x00][^\x00])+\x5C\x00/sR"; metadata:service netbios-ssn; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16400; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows GDI+ TIFF RLE compressed data buffer overflow attempt"; flow:to_client,established; file_data; content:"II*|00|"; content:"|03 01 03 00 01 00 00 00 04 00 00 00|"; distance:0; content:"P|DC 9A 86 E4 D4|7&|A1 B9|5|0D C9 A8|nMCrj|1B 93|P|DC 9A 86 E4 D4|7"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2503; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:16327; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Search unicode Search filename size integer underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|81|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4000,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14648; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans mailslot heap overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|03|"; within:1; distance:27; content:"|01 00 00 00|"; within:4; distance:1; content:!"|00|"; within:25; distance:4; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7035; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows vbscript/jscript scripting engine end buffer overflow attempt"; flow:to_client,established; content:"VBScript.Encode"; content:"^|23|~@"; distance:0; content:!"="; within:1; distance:-6; metadata:service http; reference:cve,2008-0083; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-022; classtype:attempted-user; sid:13449; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP locator nsi_binding_lookup_begin overflow attempt"; flow:established,to_server; dce_iface:d3fbb514-0e3b-11cb-8fad-08002b1d29c3; dce_opnum:0; dce_stub_data; byte_test:4,>,256,8,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,6666; reference:cve,2003-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-001; classtype:attempted-admin; sid:4754; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [138,139] (msg:"OS-WINDOWS SMB host announcement format string exploit attempt"; flow:to_server; content:"|11|"; depth:1; content:"|00 00|"; distance:11; content:"|FF|SMB%|00 00 00 00|"; within:9; distance:68; content:"|5C|MAILSLOT|5C|BROWSE|00 01|"; within:18; distance:60; content:"%"; within:16; distance:5; content:"|5C|MAILSLOT|5C|BROWSE|00 01|"; depth:18; offset:151; pcre:"/^.{5}[^\x00]*?\%(\d+\x24)?(\d+)?[nxcsd][^\x00]*?\x00/smiR"; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2012-1851; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-054; classtype:attempted-admin; sid:23837; rev:3;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS SMB client TRANS response paramcount overflow attempt"; flow:established,to_client; content:"|FF|SMB2"; depth:5; offset:4; fast_pattern; byte_test:3,>,40,1,big; isdataat:36,relative; byte_extract:2,28,total,relative,little; content:"|00 00|"; within:2; distance:2; byte_test:2,>,total,0,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:attempted-admin; sid:19972; rev:5;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft CSRSS NULL Fontface pointer attempt"; flow:to_client,established; file_data; content:"|00 74 02 EB 19 68 00 B0 40 00 E8 28 01 00 00 83 C4 04 8B 4D 08 51 FF 15 14 81 40 00 EB 18 8B 55 14 52 8B 45 10 50 8B 4D 0C 51 8B 55 08 52 FF 15|"; fast_pattern:only; metadata:service http; reference:cve,2011-1874; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-054; classtype:attempted-user; sid:19467; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows picture and fax viewer wmf arbitrary code execution attempt"; flow:to_client,established; file_data; content:"|01 00 09 00 00 03|R|1F 00 00 06 00|=|00 00 00 00 00|"; content:"&|06 09 00 16 00|"; metadata:policy security-ips drop, service http; reference:bugtraq,16074; reference:cve,2005-4560; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-001; classtype:web-application-attack; sid:5319; rev:13;)
# alert tcp $HOME_NET 445 -> $EXTERNAL_NET any (msg:"OS-WINDOWS SMB-DS Trans2 FIND_FIRST2 response andx overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3146; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MMC mmc.exe cross site scripting attempt"; flow:to_client,established; file_data; content:"res|3A|//mmc.exe"; metadata:service http; reference:bugtraq,19417; reference:cve,2006-3643; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-044; classtype:attempted-user; sid:7423; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX unicode attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15138; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Rename invalid buffer type attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8450; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product telnet uri handling code execution attempt"; flow:to_client,established; file_data; content:"telnet|3A|"; nocase; pcre:"/^[^\n]*?(\x2E(com|bat|cmd|exe)((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5c)00)/Ri"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:13271; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15131; rev:6;)
# alert ip $EXTERNAL_NET any -> 224.0.0.0/4 any (msg:"OS-WINDOWS Microsoft Windows PGM denial of service attempt"; ip_proto:113; content:"|04 01|"; depth:2; offset:4; content:"|00 04 00 08|"; within:4; distance:18; pcre:"/^.{28}[\x06\x12-\xff]\x00/s"; reference:cve,2008-1440; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-036; classtype:attempted-dos; sid:13827; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContext heap overflow attempt"; flow:established,to_server; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:1; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,<,37,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17906; reference:cve,2006-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6455; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSetUserPreferences phonebook mode overflow attempt"; flow:established,to_server; dce_iface:20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:10; dce_stub_data; byte_test:4,>,34,68,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6714; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE andx max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15211; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS CBO CBL CBM buffer overflow attempt"; flow:to_client,established; file_data; content:"Microsoft Interactive Training]"; content:"|43 43 43 43 43 43 43 43 43 43 43 43 43 43 43 43|"; content:"Syllabus="; content:"|41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41|"; metadata:service http; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-031; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-005; classtype:attempted-user; sid:17780; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; file_data; content:"bXYZ"; content:"gXYZ"; within:4; distance:8; byte_test:4,>,60,4,relative; content:"bXYZ"; within:4; distance:8; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17349; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows OLE32 MSHTA masquerade attempt"; flow:to_client,established; flowbits:isnotset,file.hta; file_data; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; nocase; content:"|D8 F4|P0|B5 98 CF 11 BB 82 00 AA 00 BD CE 0B|"; within:16; distance:60; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,13132; reference:cve,2005-0063; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-016; classtype:attempted-user; sid:3552; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Content-Disposition CLSID command attempt"; flow:to_client,established; content:"Content-Disposition|3A|"; nocase; http_header; pcre:"/^Content-Disposition\x3a(\s*|\s*\r?\n\s+)[^\r\n]*?\{[\da-fA-F]{8}(-[\da-fA-F]{4}){3}-[\da-fA-F]{12}\}/smiH"; metadata:ruleset community, service http; reference:bugtraq,9510; reference:cve,2004-0420; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-024; classtype:attempted-user; sid:2589; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product mailto uri handling code execution attempt"; flow:to_client,established; file_data; content:"mailto|3A|"; nocase; content:"|2E|com"; within:500; nocase; pcre:"/mailto\x3A[^\n]*?([\x25\x22]\x2Ecom|(\x25|\x26\x23x|\x5cx)00)/i"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:18173; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rpcss _RemoteGetClassObject attempt"; flow:established,to_server; dce_iface:b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:3; metadata:service netbios-ssn; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:11073; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; file_data; content:"|22|.cmd"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ecmd/i"; metadata:policy security-ips alert, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-061; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:12688; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15129; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Color Management Module remote code execution attempt"; flow:to_client,established; file_data; content:"|11 11 12 12 12 0B 0D 14 15 14 12 15 10 12 12 11 01 03 03 03 04 03 04 08 04 04 08 11 0B 0A 0B 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 FF C4 01 A2 00 00 01 05 01 01 01 01 01 01 00 00 00 00 00 00 00 00 01 02 03 04 05|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:cve,2005-1219; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-016; classtype:attempted-admin; sid:15894; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft .NET framework malicious XBAP attempt"; flow:to_client,established; file_data; content:"PublicKeyToken=b77a5c561934e089"; fast_pattern:only; content:"System.Collections.Generic.ICollection<T>.get_Count"; content:"TryGetGlyphTypeface|00|Exception|00|WindowsBase|00|Point|00|GlyphRun|00|IList|60 31 00|"; distance:0; content:"ComputeInkBoundingBox"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0162; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-034; classtype:attempted-user; sid:22090; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows schannel security package"; flow:to_client,established; ssl_state:server_hello; content:"|16 03 00|"; content:"|0C|"; within:1; distance:2; byte_jump:2,3,relative,big; byte_jump:2,0,relative,big; content:"|00 00|"; within:2; metadata:service ssl; reference:cve,2007-2218; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-031; classtype:attempted-user; sid:11947; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode andx max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15217; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans andx mailslot heap overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|03|"; within:1; distance:27; content:"|01 00 00 00|"; within:4; distance:1; content:!"|00|"; within:25; distance:4; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7039; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NTLM NULL session attempt"; flow:to_server,established; flowbits:isnotset,smb.null_session; content:"|FF|SMB|73 00 00 00 00|"; depth:9; offset:4; content:"|00 00|"; within:2; distance:13; content:"|FF|"; within:1; distance:9; content:"NTLMSSP|00 03 00 00 00|"; within:100; content:"|00 00 00 00 48 00 00 00|"; within:8; distance:24; fast_pattern; flowbits:set,smb.null_session; flowbits:noalert; metadata:service netbios-ssn; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:24359; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; file_data; content:"|62 69 6E EC 56 CD 6E D3 40 10 9E 34 14 A8 69 24 E0 C0 A1 27 2B 27 07 B5 56 D2 AA 07 22 15 D1|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:21508; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode andx mailslot heap overflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|03|"; within:1; distance:27; content:!"|00 00|"; within:50; distance:9; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7042; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSetUserPreferences area/country overflow attempt"; flow:established,to_server; dce_iface:20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:10; dce_stub_data; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,align,dce; byte_test:4,>,258,0,relative,dce; metadata:service netbios-ssn; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6810; rev:12;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Foundation Class applications mfc42.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|4|00|2|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18626; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS RFParalyze Attempt"; flow:to_server,established; content:"BEAVIS"; content:"yep yep"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community; reference:bugtraq,1163; reference:cve,2000-0347; reference:nessus,10392; classtype:attempted-recon; sid:1239; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Vector Markup Language recolorinfo tag numfills parameter buffer overflow attempt"; flow:to_client,established; file_data; content:"recolorinfo"; content:"numfills"; pcre:"/recolorinfo[^>]*numfills\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0024; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-004; classtype:attempted-user; sid:9848; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Groove GroovePerfmon.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|GroovePerfmon.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-016; classtype:attempted-user; sid:19315; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS name query overflow attempt TCP"; flow:established; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; metadata:ruleset community; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-006; classtype:attempted-admin; sid:3199; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Address Book wab32res.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wab32res.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-085; classtype:attempted-user; sid:18204; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans unicode Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5716; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Rename invalid buffer type unicode attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8452; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"OS-WINDOWS Microsoft Windows remote desktop oversized cookie attempt"; flow:to_server,established; content:"|03 00 00 27 22 E0|"; fast_pattern; content:"Cookie:"; distance:0; nocase; content:"mstshash="; distance:0; nocase; content:"Cookie:"; distance:0; nocase; isdataat:129; content:!"|0D 0A|"; within:129; reference:bugtraq,14259; reference:cve,2005-1218; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-041; classtype:attempted-dos; sid:21089; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB andx invalid server name share access"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"u"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,7,little,relative; content:"|5C 5C|"; distance:2; nocase; pcre:!"/^[^\x5C\x00]+\x5C/R"; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16401; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows GDI VML gradient size heap overflow attempt"; flow:to_client,established; file_data; content:"v:fill"; nocase; content:"focussize"; nocase; pcre:"/focussize\s*\x3d\s*\x22[^\x2d\x2c\x22]*\x2d[^\x2d\x22]+\x2d/smi"; metadata:policy security-ips drop, service http; reference:cve,2007-5348; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-052; classtype:attempted-user; sid:14261; rev:12;)
# alert udp any any -> any 67 (msg:"OS-WINDOWS Microsoft Windows NT DHCP REQUEST client identifier overflow attempt"; flow:to_server; content:"|63 82 53 63|"; depth:4; offset:236; content:"|35 01 03|"; within:3; content:"|3D|"; distance:0; byte_test:1,>,60,0,relative; content:"|01|"; within:1; distance:1; isdataat:60,relative; reference:bugtraq,11920; reference:cve,2004-0899; classtype:attempted-dos; sid:23230; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP rpcss2_RemoteGetClassObject attempt"; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:3; dce_stub_data; content:"|05 00|"; byte_test:2,>,5,0,dce,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:26; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:18266; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS SAP Crystal Reports crystalImageHandler.asp directory traversal attempt"; flow:to_server,established; content:"/crystalimagehandler"; fast_pattern:only; http_uri; content:"dynamicimage=../"; nocase; http_uri; metadata:ruleset community, service http; reference:bugtraq,10260; reference:cve,2004-0204; reference:nessus,12271; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-017; classtype:web-application-attack; sid:2582; rev:17;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceList attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:10; dce_stub_data; content:"|5C 5C|"; offset:16; metadata:service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:17437; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft product fputlsat.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"f|00|p|00|u|00|t|00|l|00|s|00|a|00|t|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-017; classtype:attempted-user; sid:21309; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_server,established; flowbits:isset,file.ppsx&file.zip; file_data; content:"uuid:48fd9e68-0958-11dc-9770-9797abb443b9"; fast_pattern:only; content:"2007-05-23T15:06:10-03:00"; metadata:service smtp; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:26069; rev:2;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB-DS Trans2 Distributed File System response PathConsumed integer overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2.get_dfs_referral; content:"|00|"; offset:1; content:"|FF|SMB2"; depth:5; offset:4; content:"|00 00 00 00|"; within:4; byte_test:2,>,0xFFFD,47,little,relative; flowbits:unset,smb.trans2.get_dfs_referral; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2011-1868; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-042; classtype:attempted-admin; sid:19189; rev:5;)
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft Windows ASP.NET information disclosure attempt"; flow:to_client,established; file_data; content:"HTTP/1.1 404 Not Found"; fast_pattern:only; detection_filter:track by_dst, count 100, seconds 5; metadata:policy security-ips drop, service http; reference:cve,2010-3332; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-070; classtype:misc-activity; sid:17429; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Visual Studio MFC applications mfc80.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc80.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18621; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OS-WINDOWS TCP FIN sent to client"; flow:to_client,established,no_stream; flags:+FA; flowbits:set,flags.fin; flowbits:noalert; reference:cve,2013-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-018; classtype:misc-activity; sid:25970; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"scc.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24137; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode andx Max Param/Count OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5726; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player DirectShow MPEG-2 memory corruption attempt"; flow:to_client,established; file_data; content:"|00 03 00 00 11 20|"; depth:6; byte_test:4,>,32,0,relative; metadata:service http; reference:cve,2008-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-032; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:20744; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS RPC NTLMSSP malformed credentials attempt"; flow:established,to_server; content:"NTLMSSP|00 03 00 00 00|"; content:"|00 00 00 00|"; within:4; distance:16; content:"|00 00 00 00|"; within:4; distance:4; content:"|00 00 00 00|"; within:4; distance:4; content:"|05 00 00 03 10 00 00 00|"; within:500; pcre:"/\x05\x00\x00\x03\x10\x00\x00\x00.{16}\x0a[\x03\x04]/"; metadata:service dcerpc; reference:cve,2007-2228; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-058; classtype:denial-of-service; sid:12635; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Session Setup NTMLSSP unicode asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3000; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows GDI+ compressed TIFF file parsing remote code execution attempt"; flow:to_client,established; file_data; content:"II*|00|"; content:"|03 01 03 00 01 00 00 00 04 00 00 00|"; distance:0; content:"&|A1 B9|5|0D C9 A8|nMCrj|1B 93|P|DC 9A 86 E4 D4|7&|A1 B9|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2503; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:16185; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP host-integration bind attempt"; flow:established,to_server; dce_iface:ed6ee250-e0d1-11cf-925a-00aa00c006c1; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2008-3466; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-059; classtype:protocol-command-decode; sid:14737; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS DCERPC rpcss2 _RemoteGetClassObject attempt"; content:"|5C 00 43 00 24 00 5C 00 31 00 32 00 33 00 34 00|"; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-user; sid:17112; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Agent buffer overflow attempt"; flow:to_client,established; file_data; content:"|C4 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:service http; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-068; classtype:attempted-user; sid:9432; rev:8;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS NAPTR remote unauthenticated code execution vulnerability attempt"; flow:to_client; content:"|C0 0C 00 23 00 01|"; offset:16; byte_test:1,&,0x80,2; byte_test:2,!&,0x7a0f,2; byte_jump:1,10,relative; byte_jump:1,0,relative; byte_test:1,>,0x7f,0,relative; metadata:policy security-ips drop, service dns; reference:cve,2011-1966; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-058; classtype:attempted-admin; sid:23951; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows large image resize denial of service attempt"; flow:to_client,established; file_data; content:"<img "; fast_pattern:only; pcre:"/\x3cimg[^\x3e]*?(width|height)\s*=\s*[\x22\x27]?\d{6}/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,archives.neohapsis.com/archives/fulldisclosure/2004-08/0330.html; classtype:attempted-dos; sid:23408; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE andx param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15203; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft SCCM ReportChart xss attempt"; flow:to_server,established; content:"/ReportChart.asp?"; nocase; http_uri; content:"ReportID="; nocase; http_uri; pcre:"/[?&]ReportID=\d+?&[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy security-ips drop, service http; reference:cve,2012-2536; reference:url,osvdb.org/85316; reference:url,technet.microsoft.com/security/bulletin/MS12-062; classtype:web-application-attack; sid:24128; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 99|0A|"; depth:8; metadata:service http; reference:cve,2010-2561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-051; classtype:attempted-dos; sid:18961; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; flowbits:isset,file.docm|file.docx|file.ppsx|file.pptx|file.xlsx; flowbits:isset,file.zip; file_data; content:"mx5a0ecw|21|9jX"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:26066; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Search unicode Search filename size integer underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|81|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4000,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14650; rev:8;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Vista Backup Tool fveapi.dll dll-load exploit attempt"; flow:to_server,established; content:"f|00|v|00|e|00|a|00|p|00|i|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3145; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-001; classtype:attempted-user; sid:18278; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode andx Max Param OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5738; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode Max Param OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5732; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 137 (msg:"OS-WINDOWS udp WINS WPAD registration attempt"; flow:to_server; content:"|29|"; depth:1; offset:2; content:"|00 01 00 00 00 00 00 01|"; within:8; distance:1; pcre:"/^.{2}\x29.\x00\x01\x00\x00\x00\x00\x00\x01\x20(F|H)H(F|H)A(E|G)B(E|G)ECACACA[^\x00]+\x00\x00\x20\x00\x01/s"; metadata:policy security-ips drop, service netbios-ns; reference:cve,2009-0094; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-008; classtype:misc-attack; sid:15387; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 119 (msg:"OS-WINDOWS Microsoft Windows XPAT pattern overflow attempt"; flow:to_server,established; content:"PAT"; depth:4; nocase; pcre:"/^X?PAT\s+[^\n]{160}/i"; metadata:ruleset community; reference:cve,2004-0574; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-036; classtype:attempted-admin; sid:2927; rev:10;)
# alert tcp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DNS client TXT buffer overrun attempt"; flow:to_client,established; content:"|C0 0C 00 10 00 01 00 00 00|<*|AA 00 00 00 00|"; metadata:policy security-ips drop, service dns; reference:bugtraq,19404; reference:cve,2006-3441; classtype:attempted-admin; sid:16030; rev:4;)
# alert udp any any -> any 67 (msg:"OS-WINDOWS Microsoft Windows NT DHCP DISCOVER hostname overflow attempt"; flow:to_server; content:"|63 82 53 63|"; depth:4; offset:236; content:"|35 01 01|"; within:3; content:"|0C|"; distance:0; byte_test:1,>,150,0,relative; isdataat:150,relative; reference:bugtraq,11920; reference:cve,2004-0899; classtype:attempted-dos; sid:23233; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Rename invalid buffer type unicode andx attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; metadata:service netbios-ssn; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8455; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Kerberos NULL session denial of service attempt"; flow:to_server,established; flowbits:isset,smb.null_session; content:"|FF|SMB|73 00 00 00 00|"; depth:9; offset:4; content:"|00 00|"; within:2; distance:13; content:"|FF|"; within:1; distance:9; content:"|2A 86 48 82 F7 12 01 02 02|"; fast_pattern; content:"|2A 86 48 86 F7 12 01 02 02|"; within:9; distance:2; content:"|2B 06 01 04 01 82 37 02 02|"; within:9; distance:2; metadata:service netbios-ssn; reference:cve,2012-2551; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-069; classtype:attempted-dos; sid:24360; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Session Setup NTMLSSP andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community, service netbios-ssn; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3004; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MMC mmcndmgr.dll cross site scripting attempt"; flow:to_client,established; file_data; content:"res|3A|//mmcndmgr.dll"; metadata:service http; reference:bugtraq,19417; reference:cve,2006-3643; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-044; classtype:attempted-user; sid:7422; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MHTML XSS attempt"; flow:to_client,established; file_data; content:"mhtml|3A|"; pcre:"/(location\x2ereplace\x28|window\x2elocation\x2ehref\s*?=|iframe\s*?src\s*?=|a\s*?href\s*?=)\s*?[\x22\x27]mhtml\x3a(http|file)\x3a\x2f\x2f/smi"; metadata:service http, service imap, service pop3; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:18335; rev:16;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP netware_cs NwGetConnectionInformation overflow attempt"; flow:established,to_server; dce_iface:e67ab081-9844-3521-9d32-834f038001c0; dce_opnum:1; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,128,4,relative,dce; metadata:service netbios-ssn; reference:cve,2006-4688; reference:cve,2006-4689; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-066; classtype:attempted-admin; sid:9228; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Session Setup NTMLSSP asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community, service netbios-ssn; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:2383; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:19188; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX unicode andx attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15137; rev:6;)
# alert tcp $HOME_NET 139 -> $EXTERNAL_NET any (msg:"OS-WINDOWS SMB Trans2 FIND_FIRST2 response andx overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy security-ips drop, ruleset community; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3144; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Multiple Vendors iacenc.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"i|00|a|00|c|00|e|00|n|00|c|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,42730; reference:cve,2010-3138; reference:cve,2010-3150; reference:url,osvdb.org/67554; reference:url,osvdb.org/67588; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-014; classtype:attempted-user; sid:18532; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Embedded Package Object packager.exe file load exploit attempt"; flow:to_server,established; content:"|2F|packager.exe"; nocase; http_uri; metadata:service http; reference:cve,2012-0009; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-002; classtype:attempted-user; sid:20879; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ATMFD font driver remote code execution attempt"; flow:to_client, established; file_data; content:"BellGothicStd-Bla|00 01 02 80|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2010-3957; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-091; classtype:attempted-user; sid:19119; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; file_data; content:"|10 00 11 10 B6 08 00 00 00 32 00 00 78 01 EC 5A 5D 6C 1C 57 15 3E B3 B6 13 27 4D 5D 3B 49 43 D2 40 3B 91 D3 90 D2 66 BB EB 9F FC 15 C2|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:21504; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Visual Studio MFC applications mfc40.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc40.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18619; rev:7;)
# alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"OS-WINDOWS Microsoft Windows IppRateLimitIcmp integer overflow exploit attempt"; icode:3; itype:3; detection_filter:track by_src,count 500,seconds 15; reference:cve,2011-2013; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-083; classtype:attempted-dos; sid:20543; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB andx invalid server name share access"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"u"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,7,little,relative; content:"|5C 5C|"; distance:2; nocase; pcre:!"/^[^\x5C\x00]+\x5C/R"; metadata:service netbios-ssn; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16397; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows malformed shortcut file with comment buffer overflow attempt"; flow:to_client,established; file_data; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy security-ips drop, service http; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-049; classtype:attempted-user; sid:4644; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product snews uri handling code execution attempt"; flow:to_client,established; file_data; content:"snews|3A|"; nocase; pcre:"/^[^\n]*?(\x2E(com|bat|cmd|exe)((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5c)00)/Ri"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:15684; rev:8;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP llsrpc2 LlsrLicenseRequestW overflow attempt"; dce_iface:57674CD0-5200-11CE-A897-08002B2E9C6D; dce_opnum:0; dce_stub_data; byte_jump:4,8,multiplier 2,dce; byte_test:4,>,256,16,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; classtype:attempted-admin; sid:16239; rev:7;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMBv1 BytesNeeded ring0 buffer overflow attempt"; flow:to_client,established; flowbits:isset,smb.query_sec_desc; flowbits:unset,smb.query_sec_desc; content:"|FF|SMB|A0 05 00 00 80|"; depth:9; offset:4; isdataat:24,relative; byte_jump:1,23,relative, multiplier 2; content:"|00|"; within:1; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-0269; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-020; classtype:attempted-admin; sid:16539; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows GDIplus integer overflow attempt"; flow:to_client,established; file_data; content:"|01 00 00 00|"; content:"|20|EMF"; within:4; distance:36; content:"|45 4D 46 2B 08 40|"; pcre:"/\x45\x4d\x46\x2b\x08\x40.(\x06|\x86).{28}([\xf4-\xff]\xff\xff(\xff|\x7f)|[\x00-\x06]\x00\x00\x80)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34250; reference:cve,2009-1217; classtype:misc-activity; sid:16679; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"OS-WINDOWS RPC NTLMSSP malformed credentials"; flow:to_server; content:"NTLMSSP|00 03 00 00 00|"; content:"|00 00 00 00|"; within:4; distance:16; content:"|00 00 00 00|"; within:4; distance:4; content:"|00 00 00 00|"; within:4; distance:4; content:"|05 00 00 03 10 00 00 00|"; within:500; pcre:"/\x05\x00\x00\x03\x10\x00\x00\x00.{16}\x0a[\x03\x04]/"; reference:cve,2007-2228; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-058; classtype:denial-of-service; sid:12642; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:54; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,14513; reference:cve,2005-1983; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-039; classtype:protocol-command-decode; sid:3967; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP webdav DavrCreateConnection hostname overflow attempt"; flow:established,to_server; dce_iface:C8CB7687-E6D3-11D2-A958-00C04F682E16; dce_opnum:0; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,8,relative,dce; metadata:service netbios-ssn; reference:bugtraq,16636; reference:cve,2006-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-008; classtype:attempted-admin; sid:8157; rev:12;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows wininet peerdist.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|peerdist.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3966; reference:cve,2011-2019; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-095; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-099; classtype:attempted-user; sid:18208; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Remote Desktop web access cross site scripting attempt - GET request"; flow:to_server,established; content:"/RDWeb/Pages/en-US/login.aspx"; fast_pattern:only; http_uri; content:"ReturnUrl="; nocase; http_uri; pcre:"/[?&]ReturnUrl=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy security-ips drop, service http; reference:cve,2011-1263; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-061; classtype:web-application-attack; sid:19665; rev:8;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP rpcss2_RemoteGetClassObject attempt"; dce_iface:000001a0-0000-0000-c000-000000000046; dce_opnum:3; dce_stub_data; content:"|05 00|"; byte_test:2,>,5,0,dce,relative; byte_test:4,!,0,26,dce,relative; content:"|00 00 00 00 00 00 00 00|"; within:8; distance:38; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:15513; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans unicode andx Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5733; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode andx param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15224; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows embedded OpenType font engine LZX decompression buffer overflow attempt"; flow:to_client,established; file_data; content:"|DE 0D 00 00 82 0C 00 00 02 00 02 00 E5|"; content:"SP|13 80|PYSP[|7C D0|U|FD 06|X|94 D3 E3 98 7C|"; distance:0; metadata:policy security-ips drop, service http; reference:cve,2010-0018; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-001; classtype:attempted-admin; sid:16366; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ShellExecute and IE7 snews url handling code execution attempt"; flow:to_client,established; file_data; content:"launchURL"; nocase; content:"http|3A|"; distance:0; pcre:"/[^\n]*?[\x25\x22]\x2E(com|bat|cmd|exe)/Ri"; metadata:policy security-ips alert, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:17468; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Media Encoder asferrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|asferrorenu.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18224; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15221; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP srvsvc NetrDfsCreateExitPoint dos attempt"; flow:established,to_server; dce_iface:4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:48; dce_stub_data; byte_test:4,>,65535,56,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,www.microsoft.com/technet/security/advisory/911052.mspx; classtype:attempted-dos; sid:17702; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows WebDAV pathname buffer overflow attempt"; flow:to_client,established; file_data; content:"file|3A 2F 2F 5C 5C|"; nocase; pcre:"/file\x3A\x2F\x2F\x5C\x5C[^\s\x22\x27]{234}/smi"; metadata:service http; reference:cve,2008-4259; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-073; classtype:attempted-user; sid:15115; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 137 (msg:"OS-WINDOWS name query overflow attempt TCP"; flow:to_server,established; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; metadata:ruleset community, service netbios-ns; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,www.microsoft.com/technet/security/bulletin/ms04-006.asp; classtype:attempted-admin; sid:3195; rev:9;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows shell extensions deskpan.dll dll-load exploit attempt"; flow:to_server,established; content:"d|00|e|00|s|00|k|00|p|00|a|00|n|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-1991; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-071; classtype:attempted-user; sid:20118; rev:6;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Explorer long share name buffer overflow attempt"; flow:to_client,established; content:"|00 00 00 00 F5 01 00 00 00 00 00 00 F5 01 00 00|A|00|A|00|A|00|A|00|A|00|"; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,10213; reference:cve,2004-0214; reference:url,www.microsoft.com/technet/security/bulletin/ms04-037.mspx; classtype:attempted-user; sid:15965; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP dns R_DnssrvUpdateRecord2 overflow attempt"; flow:established,to_server; dce_iface:50ABC2A4-574D-40B3-9D66-EE4FD5FBA076; dce_opnum:7; dce_stub_data; pcre:"/^.{8}(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; content:!"|00 00 00 00|"; within:4; byte_test:4,>,256,4,relative,dce; metadata:service netbios-ssn; reference:bugtraq,23470; reference:cve,2007-1748; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-029; classtype:attempted-admin; sid:10603; rev:14;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15197; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceList dos attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:10; dce_stub_data; byte_test:4,>,256,4,dce; metadata:service netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,www.microsoft.com/technet/security/advisory/911052.mspx; classtype:protocol-command-decode; sid:4918; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows .NET ArraySegment escape exploit attempt"; flow:to_client,established; file_data; content:"|00 6E 00 6E 00 6F 00 63 00 65 00 6E 00 74 00 41 00 72 00 72|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0664; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-039; classtype:attempted-user; sid:19185; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc2 LlsrLicenseRequestW overflow attempt"; flow:established,to_server; dce_iface:57674CD0-5200-11CE-A897-08002B2E9C6D; dce_opnum:0; dce_stub_data; byte_test:4,>,256,8,dce; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,12481; reference:cve,2005-0050; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-010; classtype:attempted-admin; sid:5485; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [443,465,993,995] (msg:"OS-WINDOWS Microsoft Windows SSLv3 invalid data version attempt"; flow:to_server,established; ssl_state:client_hello; ssl_version:sslv3; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; content:!"|03|"; depth:1; offset:9; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-dos; sid:3486; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1755 (msg:"OS-WINDOWS Microsoft Windows Media Service stack overflow attempt"; flow:to_server, established; content:"|CE FA 0B B0|"; content:"MMS "; within:4; distance:4; pcre:"/.{20}[\x01\x02]\x00\x03\x00.*?\x5c\x00\x5c\x00/Rsm"; isdataat:128,relative; content:!"|00 00|"; within:128; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2010-0478; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-025; classtype:attempted-admin; sid:16541; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product mailto uri handling code execution attempt"; flow:to_client,established; file_data; content:"mailto|3A|"; nocase; content:"|2E|exe"; within:500; nocase; pcre:"/mailto\x3A[^\n]*?(\x2Eexe((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5cx)00)/i"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:13272; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft XML Core Services MIME Viewer memory corruption attempt"; flow:to_client,established; file_data; content:"getElementById"; nocase; content:"setTimeout"; fast_pattern; nocase; pcre:"/\x2esrc\s*=\s*[\x22\x27]([^\x2e]+)\x2exml\x3f[\x22\x27]\s*\x2b.*\x2esrc\s*=\s*[\x22\x27]\1\x2exml\x3f[^\x22\x27]+[\x22\x27]\s\x2b/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0099; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-069; classtype:attempted-user; sid:17730; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 389 (msg:"OS-WINDOWS Microsoft Windows LSASS integer overflow attempt"; flow:to_server,established; content:"|6D 64 DE A8 E3 21 30 84 FF FF FF F9 02 01 04 63 84 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ldap; reference:cve,2010-0820; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-068; classtype:attempted-user; sid:17249; rev:6;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS SMB invalid character argument injection attempt"; flow:established,to_client; content:"|FF|SMB2|00 00 00 00|"; depth:9; offset:4; isdataat:200; byte_test:1,&,0x80,0,relative; content:"|00 00|"; within:2; distance:13; content:"|00|"; within:1; distance:13; content:"|00|"; within:1; distance:28 ; pcre:"/([^\x00]\x00){1,50}[\x3C\x3E\x3A\x22\x7C\x3F\x2A]/R"; metadata:service netbios-ssn; reference:cve,2012-0175; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-048; classtype:attempted-user; sid:23314; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows WMI tracing api integer truncation attempt"; flow:to_client,established; file_data; content:"|74 00 00 00 00 6E 74 64 6C 6C 2E 64 6C 6C 00 00 00 0A 4E 6F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-011; classtype:attempted-admin; sid:18413; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE andx max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15210; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft .NET fully qualified System.Data.dll assembly name exploit attempt"; flow:to_server,established; content:"|2F|System.Data.dll,"; nocase; http_uri; metadata:service http; reference:cve,2012-2519; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-074; classtype:attempted-user; sid:24655; rev:1;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB Negotiate Protocol response DoS attempt - empty SMB 2"; flow:to_client,established; dsize:4; content:"|00 00 00 9A|"; depth:4; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2009-3676; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-020; classtype:attempted-dos; sid:16454; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode andx max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15208; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"QE.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24133; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetRootDeviceInstance attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:7; dce_stub_data; byte_test:4,>,256,0,dce; metadata:service netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,www.microsoft.com/technet/security/advisory/911052.mspx; classtype:protocol-command-decode; sid:4826; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Search unicode andx Search filename size integer underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|81|"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4000,5,little,relative; metadata:service netbios-ssn; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14654; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Visual Studio MFC applications mfc42.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc42.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18620; rev:7;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows vbscript/jscript scripting engine begin buffer overflow attempt"; flow:to_client,established; content:"VBScript.Encode"; content:"|23|@~^"; distance:0; isdataat:6,relative; content:!"="; within:1; distance:6; reference:cve,2008-0083; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-022; classtype:attempted-user; sid:13448; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP netware_cs function 43 overflow attempt"; flow:established,to_server; dce_iface:e67ab081-9844-3521-9d32-834f038001c0; dce_opnum:43; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,512,4,relative,dce; metadata:service netbios-ssn; reference:bugtraq,15066; reference:cve,2005-1985; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-046; classtype:attempted-admin; sid:4608; rev:13;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Groove GroovePerfmon.dll dll-load exploit attempt"; flow:to_server,established; content:"G|00|r|00|o|00|o|00|v|00|e|00|P|00|e|00|r|00|f|00|m|00|o|00|n|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-016; classtype:attempted-user; sid:19314; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS Microsoft Windows LSASS integer wrap denial of service attempt"; flow:to_server, established; content:"|05|"; content:"|10|"; within:1; distance:1; content:"|0A 04|"; within:2; distance:17; content:"NTLMSSP|00 03 00 00 00|"; within:12; distance:6; content:!"|00 00|"; within:2; distance:8; byte_test:2, <, 48, 8, relative, little; metadata:service netbios-ssn; reference:cve,2009-2524; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-059; classtype:attempted-dos; sid:16167; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows hraphics engine EMF rendering vulnerability"; flow:to_client,established; file_data; content:"|C5 00 00 00 04 00 00 80 8D 00 83 00 8D 00 84 00 AF 01 10 01 AF 01 0F 01|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,15352; reference:cve,2005-2123; classtype:attempted-user; sid:17618; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"OS-WINDOWS Microsoft Windows OLEAUT32.DLL malicious WMF file remote code execution attempt"; flow:to_server,established; file_data; content:"|6C 74 01 00|"; depth:4; byte_test:4,<,60,0,relative,little; metadata:service smtp; reference:cve,2011-0658; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-038; classtype:attempted-user; sid:21357; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 161 (msg:"OS-WINDOWS Microsoft Windows getbulk request attempt"; flow:to_server; content:"0"; depth:1; byte_test:1,!&,128,0,relative; content:"|02 01 01 04|"; within:4; distance:1; byte_test:1,!&,128,0,relative; byte_jump:1,0, relative; content:"|A5|"; within:1; metadata:service snmp; reference:cve,2006-5583; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-074; classtype:attempted-admin; sid:12198; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP srvsvc NetrpPathCanonicalize path canonicalization stack overflow attempt"; flow:established,to_server; dce_iface:4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:31,32; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/\x00\.\x00\.\x00[\x2f\x5c]/R"; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2008-4250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-067; classtype:attempted-admin; sid:14782; rev:15;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft product .dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"|5C 00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-017; classtype:attempted-user; sid:18494; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Forefront UAG URL XSS attempt"; flow:to_server, established; content:"|2F|m|2F|default|2E|aspx"; fast_pattern; nocase; http_uri; content:"orig_url="; nocase; http_uri; pcre:"/orig_url=[^\x26]*[\x22\x27\x28\x29\x3C\x3E]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2734; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:attempted-admin; sid:18074; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player ASF codec list object parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.asf; file_data; content:"|40 52 D1 86 1D 31 D0 11 A3 A4 00 A0 C9 03 48 F6|"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-052; classtype:attempted-user; sid:9642; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP winreg OpenKey overflow attempt"; flow:established,to_server; dce_iface:338cd001-2244-31f1-aaaa-900038001003; dce_opnum:15; dce_stub_data; byte_test:2,>,1024,20,dce; metadata:policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-040; classtype:attempted-admin; sid:3218; rev:21;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Color Control Panel STI.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"S|00|T|00|I|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-5082; reference:url,osvdb.org/68918; reference:url,shinnai.altervista.org/exploits/SH-006-20100914.html; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-012; classtype:attempted-user; sid:21289; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX unicode attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.sql.query; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"s|00|p|00|_|00|r|00|e|00|p|00|l|00|w|00|r|00|i|00|t|00|e|00|t|00|o|00|v|00|a|00|r|00|b|00|i|00|n|00|"; distance:0; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15130; rev:6;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CryptoAPI ASN.1 integer overflow attempt"; flow:to_client,established; content:"|55 04|"; content:"|80 80 80 03 0C|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service ssl; reference:cve,2009-2511; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-056; classtype:attempted-user; sid:16181; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Metafile invalid header size integer overflow"; flow:to_client,established; file_data; content:"|D7 CD C6 9A|"; byte_test:2,<,8,25,relative,little; metadata:policy security-ips drop, service http; reference:bugtraq,16516; reference:cve,2006-0020; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-004; classtype:attempted-admin; sid:5713; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows .NET framework XMLDsig data tampering attempt "; flow:established, to_client; file_data; content:"<HMACOutputLength>"; fast_pattern:only; content:"<SignatureMethod"; nocase; pcre:"/<HMACOutputLength>\s*0\s*<\/HMACOutputLength>/Rsmi"; metadata:policy security-ips drop, service http; reference:cve,2009-0217; reference:url,osvdb.org/show/osvdb/56243; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-041; classtype:misc-attack; sid:16636; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows shell extensions deskpan.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|deskpan.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-1991; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-071; classtype:attempted-user; sid:20119; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; file_data; content:"|22|.bat"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ebat/i"; metadata:policy security-ips alert, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-061; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:12687; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Session Setup NTMLSSP unicode asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; metadata:ruleset community, service netbios-ssn; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:protocol-command-decode; sid:3003; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Vector Markup Language recolorinfo tag numcolors parameter buffer overflow attempt"; flow:to_client,established; file_data; content:"recolorinfo"; content:"numcolors"; pcre:"/recolorinfo[^>]*numcolors\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0024; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-004; classtype:attempted-user; sid:9849; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP tapisrv ClientRequest LSetAppPriority overflow attempt"; flow:established,to_server; dce_iface:2f5f6520-ca46-1067-b319-00dd010662da; dce_opnum:1; dce_stub_data; content:"E|00 00 00|"; depth:4; offset:32; byte_test:4,>,1024,-16,relative,dce; metadata:service netbios-ssn; reference:bugtraq,14518; reference:cve,2005-0058; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-040; classtype:attempted-admin; sid:9914; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans unicode andx Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4376,5,relative,little; metadata:service netbios-ssn; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5737; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15220; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 Find_First2 filename overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; content:"|00 00 00 16 00 56 05 07 00 04 01 00 00 00 00|"; within:15; distance:60; isdataat:564,relative; content:!"|00 00|"; within:564; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:attempted-admin; sid:21529; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows Address Book msoeres32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|msoeres32.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-085; classtype:attempted-user; sid:18205; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; file_data; content:"|10 00 11 10 BA 05 00 00 00 1A 00 00 78 9C ED 19 CB 6E 1C 45 B0 76 4D 88 ED 24 24 E1 4D 08 30|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:21507; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB invalid server name share access"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMBu"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,7,little,relative; content:"|5C 5C|"; distance:2; nocase; pcre:!"/^[^\x5C\x00]+\x5C/R"; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16402; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP IActivation remoteactivation overflow attempt"; flow:established,to_server; dce_iface:4d9f4ab8-7d1c-11cf-861e-0020af6e7c57; dce_opnum:0; dce_stub_data; byte_test:4,>,256,52,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service dcerpc, service netbios-ssn; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0528; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:3409; rev:15;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode andx param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"2"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15227; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 50002 (msg:"OS-WINDOWS Microsoft Forefront UAG http response splitting attempt"; flow:to_server,established; content:"/ExcelTable.asp"; nocase; content:"table="; distance:0; content:"%0d%0a"; distance:0; nocase; pcre:"/table=.*\x250d\x250a.*HTTP\/1/smi"; reference:cve,2011-1895; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-user; sid:20256; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Movie Maker hhctrl.ocx dll-load exploit attempt"; flow:to_server,established; content:"|2F|hhctrl.ocx"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3967; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-093; classtype:attempted-user; sid:18210; rev:6;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Visio mfc71 dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|7|00|1|00|"; fast_pattern; nocase; content:".|00|d|00|l|00|l|00|"; within:14; nocase; metadata:service netbios-ssn; reference:cve,2010-3148; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-055; classtype:attempted-user; sid:19465; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows UPnP Location overflow attempt"; content:"Location"; fast_pattern:only; pcre:"/^Location\s*\x3a\s*\w+\x3a\/\/([^\n]*\x3a)?[^\n]{128}/smi"; metadata:ruleset community; reference:bugtraq,3723; reference:cve,2001-0876; reference:cve,2007-2386; reference:nessus,10829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-059; classtype:misc-attack; sid:1388; rev:22;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Certification service XSS attempt"; flow:to_server,established; content:"certfnsh|2E|asp"; nocase; http_uri; content:"TargetStoreFlagsObserve"; nocase; http_client_body; pcre:"/^=[^\s\x26]*[\x3C\x3E\x22\x27\x28\x29]/R"; metadata:service http; reference:cve,2011-1264; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-051; classtype:attempted-user; sid:19186; rev:6;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB Negotiate Protocol response DoS attempt"; flow:to_client,established; dsize:4; content:"|00 00 00 01|"; depth:4; reference:cve,2009-3676; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-020; classtype:attempted-dos; sid:18195; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; file_data; content:"rXYZ"; byte_test:4,>,60,4,relative; content:"gXYZ"; within:4; distance:8; content:"bXYZ"; within:4; distance:8; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17347; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrUseAdd/NetrUseGetInfo/NetrUseDel overflow attempt"; flow:established,to_server; dce_iface:6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:8,9,10; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/\x00\.\x00\.\x00[\x2f\x5c]/R"; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2008-4250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-067; classtype:attempted-admin; sid:15015; rev:11;)
# alert tcp $HOME_NET any -> $HOME_NET 2702 (msg:"OS-WINDOWS Microsoft SMS remote control client DoS overly long length attempt"; flow:to_server,established; content:"RCH0"; fast_pattern:only; content:"RCHE"; nocase; byte_test:2,>,131,-8,relative,little; isdataat:131,relative; reference:bugtraq,10726; reference:cve,2004-0728; classtype:attempted-user; sid:3673; rev:4;)
# alert tcp $HOME_NET 139 -> $EXTERNAL_NET any (msg:"OS-WINDOWS SMB Trans2 FIND_FIRST2 command response overflow attempt"; flow:established,to_client; flowbits:isset,smb.trans2; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; pcre:"/^.{27}/R"; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy security-ips drop, ruleset community; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3143; rev:10;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Search Search filename size integer underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|81|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4000,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14647; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [135,138,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP lsass DsRolerGetPrimaryDomainInformation attempt"; dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:0; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:protocol-command-decode; sid:5096; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows embedded web font handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|53 51 86 A4 50 1D CD 50 3B D5 D0 6C E3 D5 19 36 A5 55 34 63 7A 7B B1 04 1D E7 EF 6A 69 49 8A 54 D1 73 FD 0C F7 02 5E FA 70 4E E8 68 94 FF 14 1E DC 80 7B 58 96 D0 4A 7C DF F0 5C F0 50 88 73 8D|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,16194; reference:cve,2006-0010; classtype:attempted-user; sid:17626; rev:7;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContextW invalid uuid size attempt"; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; byte_test:4,>,37,28,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6420; rev:11;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Rename invalid buffer type unicode andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8459; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB invalid server name share access"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBu"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,7,little,relative; content:"|5C 5C|"; distance:2; nocase; pcre:!"/^[^\x5C\x00]+\x5C/R"; metadata:service netbios-ssn; reference:cve,2010-0022; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:protocol-command-decode; sid:16398; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ATMFD Adobe font driver remote code execution attempt"; flow:to_client,established; file_data; content:"|F7 CE 07 0E A2 01 F7 A7 C8 03 14 E0 F7 E6 43 15 BE C9 A3 B0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,46106; reference:cve,2011-0033; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-007; classtype:attempted-user; sid:19196; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player skin decompression code execution attempt"; flow:to_client,established; file_data; content:"|5B B7 D6 CA 91 94 5C C8 DB B1 29 8F FA A4 39 A6 9B B3 65 AD 6D CE EC 2C DB 28 0F FB FD E1 F9 F5 F9 E1 F9 7C 9E 83 C1 41 7B F6 26 93 40 0A B0 0C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25307; reference:cve,2007-3035; classtype:attempted-user; sid:17228; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; file_data; content:"HTTP t_"; depth:7; content:"|0D 0A|"; within:2; distance:148; metadata:service http; reference:cve,2010-2561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-051; classtype:attempted-dos; sid:21754; rev:5;)
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"OS-WINDOWS Multiple Products excessive HTTP 304 Not Modified responses exploit attempt"; flow:to_client,established,only_stream; content:"HTTP/1.1 304 Not Modified"; detection_filter:track by_dst, count 44, seconds 1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0947; reference:cve,2007-6239; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-027; classtype:misc-activity; sid:16008; rev:12;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Search andx Search filename size integer underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|81|"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,>,4000,5,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4038; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-063; classtype:protocol-command-decode; sid:14651; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans unicode mailslot heap overflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|03|"; within:1; distance:27; content:!"|00 00|"; within:50; distance:9; reference:bugtraq,18864; reference:cve,2006-1314; reference:cve,2006-3942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-035; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:protocol-command-decode; sid:7038; rev:12;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15204; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans unicode andx Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5722; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3372 (msg:"OS-WINDOWS Microsoft Distributed Transaction Controller TIP DoS attempt"; flow:to_server,established; content:"PUSH|20|test|0A|"; depth:10; reference:bugtraq,15058; reference:cve,2005-1979; classtype:attempted-dos; sid:17439; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE andx param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15201; rev:8;)
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows remote unauthenticated DoS/bugcheck vulnerability"; icode:3; itype:3; detection_filter:track by_src,count 500,seconds 15; reference:cve,2011-1871; reference:cve,2011-2013; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-064; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-083; classtype:attempted-dos; sid:19678; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft WebDAV MiniRedir remote code execution attempt"; flow:to_client,established; file_data; content:"<D|3A|href>"; fast_pattern; nocase; isdataat:520,relative; content:!"</D|3A|href>"; within:520; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0080; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-007; classtype:attempted-user; sid:13474; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 161 (msg:"OS-WINDOWS Microsoft Windows getBulkRequest memory corruption attempt"; content:"0"; depth:1; content:"|02|"; within:1; distance:1; content:!"|00|"; within:1; distance:1; content:"|04|"; distance:2; byte_jump:1, 0, relative; content:"|A5|"; content:"|02 01 00 02 01 04 02 01 03|"; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service snmp; reference:cve,2006-5583; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-074; classtype:attempted-admin; sid:13619; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Multiple product mailto uri handling code execution attempt"; flow:to_client,established; file_data; content:"mailto|3A|"; nocase; content:"|2E|cmd"; within:500; nocase; pcre:"/mailto\x3A[^\n]*?(\x2Ecmd((?<=[\x25\x22].{4})|(?=(\x2520|\x20|\x26)))|(\x25|\x26\x23x|\x5cx)00)/i"; metadata:service http; reference:bugtraq,25053; reference:bugtraq,25945; reference:cve,2007-3845; reference:cve,2007-3896; reference:cve,2007-4041; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:18172; rev:5;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Foundation Class applications mfc100.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|1|00|0|00|0|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18629; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Object Packager ClickOnce object remote code execution attempt"; flow:to_client,established; flowbits:isset,file.ppsx&file.zip; file_data; content:"uuid:48fd9e68-0958-11dc-9770-9797abb443b9"; fast_pattern:only; content:"2007-05-23T15:06:10-03:00"; metadata:service http, service imap, service pop3; reference:cve,2012-0013; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005; classtype:attempted-user; sid:26068; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player Plugin for Non-IE browsers buffer overflow attempt"; flow:to_client,established; file_data; content:"<EMBED"; nocase; content:"src"; distance:0; nocase; pcre:"/<EMBED[^>]+?src\s*=\s*(\x22[^\x22]{1024}|\x27[^\x27]{1024}|[^\s]{1024})/i"; metadata:policy security-ips drop, service http; reference:bugtraq,16644; reference:cve,2006-0005; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-006; classtype:attempted-user; sid:5710; rev:12;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Groove mso.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mso.dll"; nocase; http_uri; metadata:service http; reference:cve,2010-3146; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-016; classtype:attempted-user; sid:18499; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows DirectX Targa image file heap overflow attempt"; flow:to_client,established; file_data; content:"|00 00 0A 00 00 00 00 00 00 00 00 00 00 80 00 80 20 20|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,24963; reference:cve,2006-4183; classtype:attempted-user; sid:17408; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceListSize attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:11; dce_stub_data; content:"|5C 00 5C 00|"; offset:16; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:17436; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP netware_cs NwrOpenEnumNdsStubTrees_Any overflow attempt"; flow:established,to_server; dce_iface:e67ab081-9844-3521-9d32-834f038001c0; dce_opnum:9; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,128,0,relative,dce; metadata:service netbios-ssn; reference:cve,2006-4688; reference:cve,2006-4689; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-066; classtype:attempted-admin; sid:9132; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSetUserPreferences callback number overflow attempt"; flow:established,to_server; dce_iface:20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:10; dce_stub_data; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align,dce; byte_test:4,>,258,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6906; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Generic HyperLink buffer overflow attempt"; flow:to_server,established; content:"GET /"; depth:5; nocase; isdataat:1450,relative; pcre:"/^GET \x2f[^\r\n]{1450}/i"; metadata:service http; reference:bugtraq,13045; reference:bugtraq,14195; reference:bugtraq,36815; reference:bugtraq,37184; reference:cve,2002-0071; reference:cve,2004-0629; reference:cve,2005-0057; reference:cve,2005-0986; reference:cve,2007-0774; reference:cve,2009-0895; reference:cve,2011-1965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-064; classtype:attempted-user; sid:17410; rev:11;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans andx Max Param/Count OS-WINDOWS attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|00 00 00 00|"; within:4; distance:5; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5725; rev:9;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB2 client NetBufferList NULL entry remote code execution attempt"; flow:to_client,established; content:"|00 00 01 FA FE|SMB@|00|"; depth:10; isdataat:130,relative; content:"|01 00|"; within:2; distance:6; content:"P|01 00 00|"; within:4; distance:6; content:"H|00 04 01|"; within:4; distance:44; content:"JST|1E|zN|D4 B7|"; within:8; distance:56; metadata:service netbios-ssn; reference:cve,2010-0477; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-020; classtype:attempted-admin; sid:16540; rev:8;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows wininet peerdist.dll dll-load exploit attempt"; flow:to_server,established; content:"p|00|e|00|e|00|r|00|d|00|i|00|s|00|t|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3966; reference:cve,2011-2019; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-095; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-099; classtype:attempted-user; sid:18209; rev:9;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"OS-WINDOWS SMB Negotiate Protocol response DoS attempt"; flow:to_client,established; content:"|00 00 00 9A FE|SMB"; depth:8; isdataat:126,relative; content:"|1E 00| LM `|1C|"; within:8; distance:118; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2009-3676; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-020; classtype:attempted-dos; sid:16287; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"OS-WINDOWS Microsoft Windows Terminal server RDP freed memory write attempt"; flow:established,to_server; content:"|7F 65 82 01 94 04 01 01 04 01 01|"; fast_pattern; byte_test:4,>,0x22,7,relative; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:1024; isdataat:512,relative; pcre:"/^\x00{512}/R"; metadata:policy security-ips drop, service rdp; reference:cve,2012-2526; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-053; classtype:attempted-admin; sid:23846; rev:2;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft products oleacc.dll dll-load exploit attempt"; flow:to_server,established; content:"o|00|l|00|e|00|a|00|c|00|c|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-1247; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-075; classtype:attempted-user; sid:20253; rev:6;)
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContextW heap overflow attempt"; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,<,37,0,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17906; reference:cve,2006-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6444; rev:11;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Media Encoder wmerrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"w|00|m|00|e|00|r|00|r|00|o|00|r|00|e|00|n|00|u|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3965; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-094; classtype:attempted-user; sid:18225; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW invalid second uuid size attempt"; flow:established,to_server; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,37,0,relative,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6431; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS replication inform2 request memory corruption attempt"; flow:to_server,established; content:"|00 00 00 03 00 00 00 09|"; depth:8; offset:12; byte_test:4,>,65535,0,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ns; reference:cve,2009-1924; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-039; classtype:attempted-admin; sid:15849; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS DCERPC Messenger Service buffer overflow attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|04 00|"; within:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-043; classtype:attempted-admin; sid:2258; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode max_param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,30,-26,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15213; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows search protocol remote command injection attempt"; flow:to_client,established; file_data; content:"src="; nocase; content:"search-ms:"; within:12; nocase; pcre:"/src=(?P<q1>[\x22\x27])\s*?search-ms\x3a[^#]*?query=[^#]*?#[^(P=q1)]*?\x2f(root|select)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2008-4269; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-075; classtype:attempted-user; sid:15116; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Rename invalid buffer type andx attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"|07|"; depth:1; offset:39; byte_jump:2,0,little,relative; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00[^\x03\x04])/Rs"; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8449; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Folder GUID Code Execution attempt"; flow:to_client,established; file_data; content:".|7B|3050F4D8-98B5-11CF-BB82-00AA00BDCE0B|7D|"; fast_pattern:only; pcre:"/\x252e\x252e\x255c[^\s\x2e]*?\x2e\x7B3050F4D8-98B5-11CF-BB82-00AA00BDCE0B\x7d/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,19389; reference:cve,2006-3281; classtype:attempted-user; sid:17316; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Shell Handler remote code execution attempt"; flow:to_client,established; file_data; content:"href"; nocase; content:"|23 3A|//"; within:500; fast_pattern; pcre:"/\<a\s+[^\>]*href\s*\x3D\s*[\x22\x27]?[^\>\x22\x27]*\x23\x3A\x2F\x2F[^\>]+\>/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-007; classtype:attempted-user; sid:16414; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceList attempt"; flow:established,to_server; dce_iface:8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:10; dce_stub_data; content:"|5C 00 5C 00|"; offset:16; metadata:service netbios-ssn; reference:bugtraq,15065; reference:cve,2005-2120; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-047; classtype:protocol-command-decode; sid:17435; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows Print Spooler arbitrary file write attempt"; flow:to_server,established; dce_iface:12345678-1234-abcd-ef00-0123456789ab; dce_opnum:17; dce_stub_data; content:"|01 00 00 00|"; depth:4; offset:20; pcre:"/\x2E\x00(e\x00x\x00e|d\x00l\x00l\x00|m\x00o\x00f\x00|s\x00h\x00n\x00)/iR"; metadata:service netbios-ssn; reference:cve,2010-2729; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-061; classtype:attempted-user; sid:17252; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Foundation Class applications mfc90.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|9|00|0|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18628; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS association context validation overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; content:"|00 E4 FF 58|"; depth:4; offset:16; metadata:service wins; reference:bugtraq,11763; reference:cve,2004-0567; reference:cve,2004-1080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-045; reference:url,www.immunitysec.com/downloads/instantanea.pdf; classtype:misc-attack; sid:18320; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft CSRSS NULL Fontface pointer attempt"; flow:to_client,established; file_data; content:"|74 02 EB 19 68 00 00 01 00 0F B7 45 EC 50 68 D0 F0 42 00 E8 DA F3 FF FF 83 C4 0C EB A1 0F B7 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-1282; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-056; classtype:attempted-user; sid:19461; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Rename invalid buffer type unicode attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|07|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; pcre:"/^.{5}([^\x03\x04]|.[^\x00]+\x00\x00[^\x03\x04])/Rs"; metadata:service netbios-ssn; reference:cve,2006-4696; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-063; classtype:attempted-dos; sid:8456; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft SilverLight ImageSource redefine flowbit"; flow:to_client,established; file_data; content:"|2E|findName|28 22|"; content:"|2E|ImageSource"; distance:0; pcre:"/var\s*(?P<imagebrush>\w+?)\x3b.*?(?P=imagebrush)\s*\x3d\s*[^\x3b\x2e]+\x2efindName\x28.*?(?P=imagebrush)\x2eImageSource\s*\x3d\s*[\x22\x21][^\x2e\x22\x21]+?[\x22\x21]/smi"; flowbits:set,imagesource.redefine; metadata:service http, service imap, service pop3; classtype:misc-activity; sid:17113; rev:11;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 137 (msg:"OS-WINDOWS name query overflow attempt UDP"; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; metadata:ruleset community, service netbios-ns; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,www.microsoft.com/technet/security/bulletin/ms04-006.asp; classtype:attempted-admin; sid:3196; rev:7;)
# alert tcp $HOME_NET any -> any [137,139] (msg:"OS-WINDOWS SMB Microsoft Windows RAP API NetServerEnum2 long server name buffer overflow attempt"; flow:to_server,established; content:"|68 00|WrLehD"; pcre:"/^[oz]/Ri"; content:"|01 00|"; within:2; distance:9; flowbits:set,netsenum; flowbits:noalert; metadata:policy security-ips drop, service netbios-ssn; reference:bugtraq,54940; reference:cve,2012-1853; reference:url,osvdb.org/84601; reference:url,technet.microsoft.com/security/bulletin/MS12-054; classtype:attempted-dos; sid:23839; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS SMB-DS Trans Max Param/Count OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00 00 00|"; within:4; distance:5; metadata:service netbios-ssn; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:5717; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Media Player ASF marker object parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.asf; file_data; content:"|01 CD 87 F4 51 A9 CF 11 8E E6 00 C0 0C 20 53 65|"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-078; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-052; classtype:attempted-user; sid:9643; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft product fputlsat.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|fputlsat.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-017; classtype:attempted-user; sid:21310; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 389 (msg:"OS-WINDOWS Microsoft Windows Active Directory LDAP denial of service attempt"; flow:to_server,established; content:"0"; depth:1; content:"|02|"; within:20; content:"c"; within:20; content:"=|23|04"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ldap; reference:cve,2009-1138; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-018; classtype:attempted-admin; sid:15527; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSubmitRequest overflow attempt"; flow:established,to_server; dce_iface:20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:10,12; dce_stub_data; byte_test:4,>,8192,4,dce; metadata:service netbios-ssn; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6584; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Fax Services Cover Page Editor overflow attempt"; flow:to_client,established; file_data; content:"FAXCOVER-VER005w"; nocase; content:"|87 00 00 00 4C 17 00 00 00 00 00 00 52 03 00 00|"; within:100; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.vupen.com/english/advisories/2010/3327; classtype:attempted-user; sid:18246; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP spoolss AddPrinter overflow attempt"; flow:established,to_server; dce_iface:12345678-1234-abcd-ef00-0123456789ab; dce_opnum:5; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,28,relative,dce; metadata:service netbios-ssn; reference:bugtraq,14514; reference:cve,2005-1984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-043; classtype:attempted-admin; sid:11843; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrGetJoinInformation attempt"; flow:established,to_server; dce_iface:6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:20; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2009-1544; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-041; classtype:protocol-command-decode; sid:15860; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft Windows WINS overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; isdataat:24; content:!"|00 00 00 02|"; depth:4; offset:12; content:"|00 00 00 06|"; within:4; distance:16; byte_test:4,>,276,0,relative; metadata:service wins; reference:bugtraq,11922; reference:cve,2004-0567; reference:cve,2004-1080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-045; classtype:misc-attack; sid:11684; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB sp_replwritetovarbin vulnerable function WriteAndX attempt"; flowbits:isset,smb.tree.create.sql.query; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"sp_replwritetovarbin"; distance:0; metadata:policy security-ips drop; reference:bugtraq,32710; reference:cve,2008-5416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-004; classtype:attempted-admin; sid:15136; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows WebDAV invalid character argument injection attempt"; flow:to_client,established; flowbits:isset,ms.webdav.propfind; file_data; content:"<D:href"; fast_pattern; nocase; content:"%"; within:50; pcre:"/^(3C|3E|3A|22|7C|3F|2A)/iR"; metadata:policy security-ips drop, service http; reference:bugtraq,54307; reference:cve,2012-0175; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-048; classtype:attempted-user; sid:24090; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Anti-Cross Site Scripting library bypass attempt"; flow:established,to_client; file_data; content:"style="; nocase; content:"|5C 2C 22|"; within:50; fast_pattern; content:"expression"; within:50; nocase; pcre:"/style\s*=\s*\x27?[^\x27]*?\x5C\x2C\x22[^\x27]+expression\s*\x28/"; metadata:policy security-ips drop, service http; reference:cve,2012-0007; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-007; classtype:attempted-user; sid:21405; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Help Centre escape sequence XSS attempt"; flow:to_client,established; file_data; content:"hcp|3A 2F 2F|"; nocase; content:"script"; distance:0; nocase; content:"defer"; distance:0; nocase; pcre:"/hcp\x3a\x2f\x2f[^\n]*(\x3c|\x253c)script(\s|\x2520|\x2f)+defer/iO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40725; reference:cve,2010-1885; reference:url,osvdb.org/show/osvdb/65264; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-042; classtype:attempted-user; sid:16665; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Windows SMB malformed process ID high field remote code execution attempt"; flow:to_server,established; dsize:>100; content:"|02|SMB 2"; fast_pattern:only; content:"|FF|SMBr|00 00 00|"; depth:8; offset:4; content:!"|00 00|"; within:2; distance:4; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2009-2532; reference:cve,2009-3103; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-050; reference:url,www.microsoft.com/technet/security/advisory/975497.mspx; classtype:attempted-admin; sid:15930; rev:15;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows CryptoAPI common name spoofing attempt"; flow:to_client,established; ssl_state:server_hello; content:"|55 04 03 0C|"; byte_extract:1,0,namelen,relative; content:"|00|"; within:namelen; metadata:policy security-ips drop, service ssl; reference:cve,2009-2510; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-056; classtype:misc-attack; sid:24489; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB startup folder unicode access"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB2"; depth:5; offset:4; content:"|5C 00|S|00|t|00|a|00|r|00|t|00| |00|M|00|e|00|n|00|u|00 5C 00|P|00|r|00|o|00|g|00|r|00|a|00|m|00|s|00 5C 00|S|00|t|00|a|00|r|00|t|00|u|00|p"; distance:0; nocase; metadata:ruleset community; classtype:attempted-recon; sid:2177; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Agent buffer overflow attempt"; flow:to_client,established; file_data; content:"|C2 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:policy security-ips drop, service http; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-068; classtype:attempted-user; sid:9433; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2869 (msg:"OS-WINDOWS Microsoft Windows UPnP notification type overflow attempt"; flow:to_server,established; content:"SUBSCRIBE"; fast_pattern:only; pcre:"/^(UN)?SUBSCRIBE\s/smi"; pcre:"/^(NT|CallBack|SID|TimeOut)\s*\x3a\s*[^\n]{512}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,23371; reference:cve,2007-1204; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-019; classtype:attempted-admin; sid:10475; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrAddAlternateComputerName overflow attempt"; flow:established,to_server; dce_iface:6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:27; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; content:!"|00 00 00 00|"; within:4; byte_test:4,>,256,4,relative,dce; metadata:service netbios-ssn; reference:bugtraq,9011; reference:cve,2003-0812; reference:nessus,11921; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-049; classtype:attempted-admin; sid:8925; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ShellExecute and IE7 snews url handling code execution attempt"; flow:to_client,established; file_data; content:"document|2E|location|2E|replace"; content:"|2E|exe"; distance:0; nocase; content:"|2E|pdf"; distance:0; nocase; pcre:"/document\x2Elocation\x2Ereplace\s*\x28\s*(\x22|\x27)[a-z0-9]+\.exe\?[a-z0-9]+\.pdf/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-057; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; classtype:attempted-user; sid:17467; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [389,3268] (msg:"OS-WINDOWS Microsoft Windows Active Directory Crafted LDAP ModifyRequest"; flow:to_server,established; content:"0|84|"; depth:2; content:"|66 84|"; within:16; byte_test:4,>,0x0F0000,2; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-039; classtype:attempted-admin; sid:12069; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode andx param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"|A0|"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15200; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS Microsoft Windows SMBv2 integer overflow denial of service attempt"; flow:to_server, established; content:"|FE|SMB|40 00|"; isdataat:1000; content:"|00 00 00 00 0B 00|"; within:6; distance:2; content:"|94 01 06 00|"; within:4; distance:54; fast_pattern; byte_test:4,>,61440,20,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2009-2526; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-050; classtype:attempted-admin; sid:16168; rev:7;)
alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB v4 srvsvc NetrpPathCononicalize unicode path cononicalization stack overflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; pcre:"/^.{28}(\x00\x1f|\x00\x20)/sR"; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/\x00\.\x00\.\x00[\x2f\x5c]/R"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service netbios-dgm; reference:cve,2008-4250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-067; classtype:attempted-admin; sid:14896; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP spoolss AddPrinterEx overflow attempt"; flow:established,to_server; dce_iface:12345678-1234-abcd-ef00-0123456789ab; dce_opnum:70; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,>,256,96,relative,dce; metadata:service netbios-ssn; reference:bugtraq,14514; reference:cve,2005-1984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-043; classtype:attempted-admin; sid:4413; rev:13;)
# alert icmp $HOME_NET any -> 224.0.0.1 any (msg:"OS-WINDOWS Microsoft Windows remote kernel tcp/ip icmp vulnerability exploit attempt"; itype:9; byte_test:1,>,150,0; reference:cve,2007-0066; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-001; classtype:attempted-admin; sid:13288; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft .NET framework EvidenceBase class remote code execution attempt"; flow:to_client,established; file_data; content:"<Module>|00|"; content:"|00|MyEvidence|00|MyAssembly|00|De"; within:25; distance:9; metadata:service http, service imap, service pop3; reference:cve,2012-0160; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-035; classtype:attempted-user; sid:22079; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] (msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMDeleteObject overflow attempt"; dce_iface:FDB3A030-065F-11D1-BB9B-00A024EA5525; dce_opnum:9; dce_stub_data; content:"|01 00 00 00|"; depth:4; offset:4; content:"|03 00 00 00|"; within:4; distance:4; byte_test:4,>,256,8,dce; metadata:service dcerpc; reference:cve,2005-0059; reference:nessus,18027; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:3591; rev:16;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB NT Trans NT CREATE max_param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,69,-27,relative,little; metadata:policy security-ips drop; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15207; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"OS-WINDOWS Microsoft Windows remote desktop denial of service attempt"; flow:to_server,established; content:"|30|"; depth:1; content:"|03 00 00 27 22 E0|"; within:6; distance:1; content:"mstshash="; distance:0; nocase; reference:bugtraq,14259; reference:cve,2005-1218; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-041; classtype:attempted-dos; sid:21088; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OS-WINDOWS TCP FIN handshake resource exhaustion attempt"; flow:to_server,established,no_stream; flowbits:isset,flags.fin; flags:!R; window:0; detection_filter:track by_dst, count 100, seconds 10; reference:cve,2013-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-018; classtype:denial-of-service; sid:25774; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows WMI tracing api integer truncation attempt"; flow:to_client,established; file_data; content:"|74 00 00 00 00 6E 74 64 6C 6C 2E 64 6C 6C 00 00 00 0A 4E 6F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-011; classtype:attempted-admin; sid:18408; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Comctl32.dll third-party SVG viewer heap overflow attempt"; flow:to_client,established; file_data; content:"<svg "; nocase; content:"<rect "; distance:0; nocase; content:"transform"; distance:0; nocase; pcre:"/<rect[^>]+transform\s*=\s*[\x22\x27][^\x22\x27]{500}/Osmi"; metadata:policy security-ips drop, service http; reference:cve,2010-2746; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-081; classtype:attempted-user; sid:18297; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET 42 (msg:"OS-WINDOWS Microsoft WINS service oversize payload exploit attempt"; flow:to_server,established,no_stream; dsize:>1400; reference:cve,2011-1248; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-035; classtype:attempted-admin; sid:18950; rev:3;)
# alert udp $HOME_NET any -> 224.0.0.0/4 5355 (msg:"OS-WINDOWS Microsoft Windows LLMNR invalid reverse name lookup stack corruption attempt "; content:"|00 01 00 00 00 00|"; depth:6; offset:4; content:"|01 2E|"; within:2; distance:2; byte_test:2,!&,0xF8,2; metadata:policy security-ips drop; reference:cve,2011-0657; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-030; classtype:attempted-admin; sid:18655; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS NETAPI RPC interface reboot attempt"; flow:established, to_server; dce_iface:12345678-1234-ABCD-EF00-01234567CFFB; dce_opnum:29; dce_stub_data; content:"|00 00|"; content:"|01 00 00 00 00 00 00 00|"; within:8; distance:30; pcre:"/\x00\x00.{30}\x01\x00{7}$/"; metadata:service netbios-ssn; reference:cve,2010-2742; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-101; classtype:attempted-user; sid:18215; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS SMB NT Trans NT CREATE unicode param_count underflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB|A0|"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|01 00|"; within:2; distance:37; byte_test:4,<,54,-19,relative,little; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2008-4834; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15196; rev:9;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:21281; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft product .dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-017; classtype:attempted-user; sid:18495; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"OS-WINDOWS SMB Trans Max Param OS-WINDOWS attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,>,4376,5,relative,little; reference:bugtraq,13942; reference:cve,2005-1206; reference:nessus,18483; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-027; classtype:protocol-command-decode; sid:5729; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW heap overflow attempt"; flow:established,to_server; dce_iface:906B0CE0-C70B-1067-B317-00DD010662DA; dce_opnum:7; dce_stub_data; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align,dce; byte_test:4,<,37,0,relative,dce; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:bugtraq,17906; reference:cve,2006-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6443; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP lsass DsRolerUpgradeDownlevelServer overflow attempt"; flow:established,to_server; dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:9; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, ruleset community, service netbios-ssn; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2508; rev:18;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Microsoft ASP.NET canonicalization exploit attempt"; flow:to_server,established; content:"GET /fsc/secured|5C|fsc.aspx HTTP/1.1"; metadata:policy security-ips drop, service http; reference:bugtraq,11342; reference:cve,2004-0847; classtype:attempted-user; sid:15985; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows Vector Markup Language fill method overflow attempt"; flow:to_client,established; file_data; content:"|3A|fill"; nocase; content:"method"; distance:0; nocase; pcre:"/<\w+\x3afill\s[^>]*method\s*=\s*(\x27[^\x27]{32}|\x22[^\x22]{32}|[^\s>]{32})/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-055; classtype:attempted-user; sid:8416; rev:14;)
# alert udp any any -> any 53 (msg:"OS-WINDOWS Microsoft Windows NAT helper components udp denial of service attempt"; flow:to_server; byte_test:2,&,256,2; content:"|00 00 00 00 00 00 00 00|"; depth:8; offset:4; metadata:policy security-ips drop, service dns; reference:cve,2006-5614; classtype:misc-attack; sid:8710; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows WebDAV search overflow attempt"; flow:to_server,established; content:"SEARCH"; nocase; http_method; isdataat:1000; content:!"|0A|"; depth:1000; metadata:policy security-ips drop, service http; reference:cve,2003-0109; reference:cve,2003-0226; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-007; classtype:attempted-admin; sid:11686; rev:13;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"OS-WINDOWS Microsoft Foundation Class applications mfc40.dll dll-load exploit attempt"; flow:to_server,established; content:"m|00|f|00|c|00|4|00|0|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2010-3190; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-025; classtype:attempted-user; sid:18625; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"OS-WINDOWS possible SMB replay attempt - overlapping encryption keys detected"; flow:to_server,established; content:"|6E 81 00 42 3B 04 82 9D B8 97 A6 30 32 2D D5 28 B7 2C DF A3 7E 2B 16 8E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ns; reference:cve,2008-3009; reference:cve,2008-4037; reference:cve,2009-0550; reference:cve,2009-1930; reference:cve,2010-0231; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-068; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-013; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-014; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:attempted-user; sid:17723; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"OS-WINDOWS Visual Studio Team Web Access console cross site scripting attempt"; flow:established,to_server; content:"diff.aspx"; nocase; http_uri; content:"name="; distance:0; nocase; http_uri; pcre:"/[?&]name=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1892; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-061; classtype:web-application-attack; sid:24136; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"OS-WINDOWS Microsoft Windows SPNEGO ASN.1 library heap corruption overflow attempt"; flow:to_server,established; content:"Authorization|3A|"; nocase; http_header; content:"Negotiate"; within:50; fast_pattern; nocase; http_header; pcre:"/^Authorization\x3a\s*Negotiate\s*((YE4G.{40}LgMc)|(YIIQ.{40}(QUFB|hAJ9)))/smiH"; metadata:service http; reference:bugtraq,9633; reference:cve,2003-0818; reference:cve,2005-1935; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; reference:url,www.phreedom.org/solar/exploits/msasn1-bitstring/; classtype:attempted-admin; sid:12058; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"OS-WINDOWS SMB Trans2 OPEN2 unicode param_count underflow attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB2"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"|00 00|"; within:2; distance:29; byte_test:2,<,29,-12,relative,little; metadata:policy security-ips drop; reference:cve,2008-4835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-001; classtype:protocol-command-decode; sid:15223; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"OS-WINDOWS Microsoft Windows 2000 Kodak Imaging large offset malformed jpeg tables"; flow:to_client,established; file_data; content:"|0D 0A FF D8|"; content:"|FF DB|"; distance:0; byte_test:2, >, 32767, 2, relative; metadata:service http; reference:cve,2007-2217; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; classtype:attempted-user; sid:12632; rev:9;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"OS-WINDOWS DCERPC NCACN-IP-TCP spoolss EnumJobs attempt"; flow:established,to_client; dce_iface:12345678-1234-abcd-ef00-0123456789ab; dce_opnum:4; dce_stub_data; byte_jump:4,4,dce; byte_test:4,>,1024,1,relative,dce; metadata:service netbios-ssn; reference:cve,2008-1446; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-062; classtype:protocol-command-decode; sid:14710; rev:15;)
